/*!
 * Cropper v3.1.3
 * https://github.com/fengyuanchen/cropper
 *
 * Copyright (c) 2014-2017 Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2017-10-21T10:04:29.734Z
 */
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(n.jQuery)}(this,function(n){"use strict";function tt(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function it(n){return"string"==typeof n}function t(n){return"number"==typeof n&&!dt(n)}function o(n){return void 0===n}function u(n,t){for(var r=arguments.length,u=Array(r>2?r-2:0),i=2;i<r;i++)u[i-2]=arguments[i];return function(){for(var r=arguments.length,f=Array(r),i=0;i<r;i++)f[i]=arguments[i];return n.apply(t,u.concat(f))}}function f(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return gt.test(n)?Math.round(n*t)/t:n}function v(n){var t=n.match(ni);return t&&(t[1]!==a.protocol||t[2]!==a.hostname||t[3]!==a.port)}function y(n){var t="timestamp="+(new Date).getTime();return n+(-1===n.indexOf("?")?"?":"&")+t}function s(n){var r=n.rotate,u=n.scaleX,f=n.scaleY,e=n.translateX,o=n.translateY,i=[];return t(e)&&0!==e&&i.push("translateX("+e+"px)"),t(o)&&0!==o&&i.push("translateY("+o+"px)"),t(r)&&0!==r&&i.push("rotate("+r+"deg)"),t(u)&&1!==u&&i.push("scaleX("+u+")"),t(f)&&1!==f&&i.push("scaleY("+f+")"),i.length?i.join(" "):"none"}function rt(n,t){if(!n.naturalWidth||ti){var i=document.createElement("img");i.onload=function(){t(i.width,i.height)};i.src=n.src}else t(n.naturalWidth,n.naturalHeight)}function ut(t){var r=n.extend({},t),i=[];return n.each(t,function(t,u){delete r[t];n.each(r,function(n,t){var r=Math.abs(u.startX-t.startX),f=Math.abs(u.startY-t.startY),e=Math.abs(u.endX-t.endX),o=Math.abs(u.endY-t.endY),s=Math.sqrt(r*r+f*f),h=(Math.sqrt(e*e+o*o)-s)/s;i.push(h)})}),i.sort(function(n,t){return Math.abs(n)<Math.abs(t)}),i[0]}function h(t,i){var r=t.pageX,u=t.pageY,f={endX:r,endY:u};return i?f:n.extend({startX:r,startY:u},f)}function ft(t){var i=0,r=0,u=0;return n.each(t,function(n,t){var f=t.startX,e=t.startY;i+=f;r+=e;u+=1}),i/=u,r/=u,{pageX:i,pageY:r}}function e(n){var r=n.aspectRatio,t=n.height,i=n.width,u=function(n){return ii(n)&&n>0};return u(i)&&u(t)?t*r>i?t=i/r:i=t*r:u(i)?t=i/r:u(t)&&(i=t*r),{width:i,height:t}}function et(n){var t=n.width,i=n.height,r=n.degree;if((r=Math.abs(r))%180==90)return{width:i,height:t};var u=r%90*Math.PI/180,f=Math.sin(u),e=Math.cos(u);return{width:t*e+i*f,height:t*f+i*e}}function ot(t,i,r,u){var l=i.naturalWidth,a=i.naturalHeight,v=i.rotate,et=void 0===v?0:v,y=i.scaleX,ot=void 0===y?1:y,p=i.scaleY,st=void 0===p?1:p,w=r.aspectRatio,ht=r.naturalWidth,ct=r.naturalHeight,b=u.fillColor,lt=void 0===b?"transparent":b,k=u.imageSmoothingEnabled,at=void 0===k||k,d=u.imageSmoothingQuality,vt=void 0===d?"low":d,g=u.maxWidth,yt=void 0===g?1/0:g,nt=u.maxHeight,pt=void 0===nt?1/0:nt,it=u.minWidth,wt=void 0===it?0:it,rt=u.minHeight,bt=void 0===rt?0:rt,ut=e({aspectRatio:w,width:yt,height:pt}),ft=e({aspectRatio:w,width:wt,height:bt}),h=Math.min(ut.width,Math.max(ft.width,ht)),c=Math.min(ut.height,Math.max(ft.height,ct)),s=document.createElement("canvas"),o=s.getContext("2d"),kt=[-l/2,-a/2,l,a];return s.width=f(h),s.height=f(c),o.fillStyle=lt,o.fillRect(0,0,h,c),o.save(),o.translate(h/2,c/2),o.rotate(et*Math.PI/180),o.scale(ot,st),o.imageSmoothingEnabled=!!at,o.imageSmoothingQuality=vt,o.drawImage.apply(o,[t].concat(tt(n.map(kt,function(n){return Math.floor(f(n))})))),o.restore(),s}function st(n,t,i){var u="",r=void 0;for(i+=t,r=t;r<i;r+=1)u+=g(n.getUint8(r));return u}function ht(t){var f=t.replace(ri,""),i=atob(f),r=new ArrayBuffer(i.length),u=new Uint8Array(r);return n.each(u,function(n){u[n]=i.charCodeAt(n)}),r}function ct(t,i){var u=new Uint8Array(t),r="";return n.each(u,function(n,t){r+=g(t)}),"data:"+i+";base64,"+btoa(r)}function lt(n){var t=new DataView(n),l=void 0,i=void 0,e=void 0,o=void 0,a,r,u,h,c;if(255===t.getUint8(0)&&216===t.getUint8(1))for(a=t.byteLength,r=2;r<a;){if(255===t.getUint8(r)&&225===t.getUint8(r+1)){e=r;break}r+=1}if(e&&(u=e+10,"Exif"===st(t,e+4,4)&&(h=t.getUint16(u),((i=18761===h)||19789===h)&&42===t.getUint16(u+2,i)&&(c=t.getUint32(u+4,i),c>=8&&(o=u+c)))),o)for(var v=t.getUint16(o,i),f=void 0,s=void 0,s=0;s<v;s+=1)if(f=o+12*s+2,274===t.getUint16(f,i)){f+=8;l=t.getUint16(f,i);t.setUint16(f,1,i);break}return l}function at(n){var t=0,i=1,r=1;switch(n){case 2:i=-1;break;case 3:t=-180;break;case 4:r=-1;break;case 5:t=90;r=-1;break;case 6:t=90;break;case 7:t=90;i=-1;break;case 8:t=-90}return{rotate:t,scaleX:i,scaleY:r}}function vt(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function yt(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var nt;n=n&&n.hasOwnProperty("default")?n.default:n;var r="undefined"!=typeof window?window:{},i="cropper-hidden",p=r.PointerEvent?"pointerdown":"touchstart mousedown",w=r.PointerEvent?"pointermove":"touchmove mousemove",b=r.PointerEvent?" pointerup pointercancel":"touchend touchcancel mouseup",pt=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,wt=/^data:/,bt=/^data:image\/jpeg;base64,/,kt=/^(img|canvas)$/i,k={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},dt=Number.isNaN||r.isNaN,c=Object.keys||function(t){var i=[];return n.each(t,function(n){i.push(n)}),i},gt=/\.\d*(?:0|9){12}\d*$/i,a=r.location,ni=/^(https?:)\/\/([^:/?#]+):?(\d*)/i,d=r.navigator,ti=d&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(d.userAgent),ii=Number.isFinite||r.isFinite,g=String.fromCharCode,ri=/^data:.*,/,ui={render:function(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.$element,r=this.options,u=this.$container,n=this.$cropper;n.addClass(i);t.removeClass(i);n.css(this.container={width:Math.max(u.width(),Number(r.minContainerWidth)||200),height:Math.max(u.height(),Number(r.minContainerHeight)||100)});t.addClass(i);n.removeClass(i)},initCanvas:function(){var t=this.container,r=this.image,f=this.options.viewMode,s=Math.abs(r.rotate)%180==90,h=s?r.naturalHeight:r.naturalWidth,c=s?r.naturalWidth:r.naturalHeight,u=h/c,e=t.width,o=t.height,i;t.height*u>t.width?3===f?e=t.height*u:o=t.width/u:3===f?o=t.width/u:e=t.height*u;i={aspectRatio:u,naturalWidth:h,naturalHeight:c,width:e,height:o};i.left=(t.width-e)/2;i.top=(t.height-o)/2;i.oldLeft=i.left;i.oldTop=i.top;this.canvas=i;this.limited=1===f||2===f;this.limitCanvas(!0,!0);this.initialImage=n.extend({},r);this.initialCanvas=n.extend({},i)},limitCanvas:function(n,t){var v=this.options,o=this.container,i=this.canvas,f=this.cropBox,h=v.viewMode,s=i.aspectRatio,a=this.cropped&&f,r,u,y,c,l;n&&(r=Number(v.minCanvasWidth)||0,u=Number(v.minCanvasHeight)||0,h>0&&(h>1?(r=Math.max(r,o.width),u=Math.max(u,o.height),3===h&&(u*s>r?r=u*s:u=r/s)):r?r=Math.max(r,a?f.width:0):u?u=Math.max(u,a?f.height:0):a&&(r=f.width,(u=f.height)*s>r?r=u*s:u=r/s)),y=e({aspectRatio:s,width:r,height:u}),r=y.width,u=y.height,i.minWidth=r,i.minHeight=u,i.maxWidth=1/0,i.maxHeight=1/0);t&&(h>0?(c=o.width-i.width,l=o.height-i.height,i.minLeft=Math.min(0,c),i.minTop=Math.min(0,l),i.maxLeft=Math.max(0,c),i.maxTop=Math.max(0,l),a&&this.limited&&(i.minLeft=Math.min(f.left,f.left+f.width-i.width),i.minTop=Math.min(f.top,f.top+f.height-i.height),i.maxLeft=f.left,i.maxTop=f.top,2===h&&(i.width>=o.width&&(i.minLeft=Math.min(0,c),i.maxLeft=Math.max(0,c)),i.height>=o.height&&(i.minTop=Math.min(0,l),i.maxTop=Math.max(0,l))))):(i.minLeft=-i.width,i.minTop=-i.height,i.maxLeft=o.width,i.maxTop=o.height))},renderCanvas:function(n,t){var i=this.canvas,r=this.image;if(t){var e=et({width:r.naturalWidth*Math.abs(r.scaleX||1),height:r.naturalHeight*Math.abs(r.scaleY||1),degree:r.rotate||0}),u=e.width,f=e.height,o=i.width*(u/i.naturalWidth),h=i.height*(f/i.naturalHeight);i.left-=(o-i.width)/2;i.top-=(h-i.height)/2;i.width=o;i.height=h;i.aspectRatio=u/f;i.naturalWidth=u;i.naturalHeight=f;this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft);(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop);i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth);i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight);this.limitCanvas(!1,!0);i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft);i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop);i.oldLeft=i.left;i.oldTop=i.top;this.$canvas.css({width:i.width,height:i.height,transform:s({translateX:i.left,translateY:i.top})});this.renderImage(n);this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(t){var r=this.canvas,i=this.image,u=i.naturalWidth*(r.width/r.naturalWidth),f=i.naturalHeight*(r.height/r.naturalHeight);n.extend(i,{width:u,height:f,left:(r.width-u)/2,top:(r.height-f)/2});this.$clone.css({width:i.width,height:i.height,transform:s(n.extend({translateX:i.left,translateY:i.top},i))});t&&this.output()},initCropBox:function(){var u=this.options,i=this.canvas,r=u.aspectRatio,f=Number(u.autoCropArea)||.8,t={width:i.width,height:i.height};r&&(i.height*r>i.width?t.height=t.width/r:t.width=t.height*r);this.cropBox=t;this.limitCropBox(!0,!0);t.width=Math.min(Math.max(t.width,t.minWidth),t.maxWidth);t.height=Math.min(Math.max(t.height,t.minHeight),t.maxHeight);t.width=Math.max(t.minWidth,t.width*f);t.height=Math.max(t.minHeight,t.height*f);t.left=i.left+(i.width-t.width)/2;t.top=i.top+(i.height-t.height)/2;t.oldLeft=t.left;t.oldTop=t.top;this.initialCropBox=n.extend({},t)},limitCropBox:function(n,t){var c=this.options,r=this.container,o=this.canvas,i=this.cropBox,l=this.limited,e=c.aspectRatio;if(n){var u=Number(c.minCropBoxWidth)||0,f=Number(c.minCropBoxHeight)||0,s=Math.min(r.width,l?o.width:r.width),h=Math.min(r.height,l?o.height:r.height);u=Math.min(u,r.width);f=Math.min(f,r.height);e&&(u&&f?f*e>u?f=u/e:u=f*e:u?f=u/e:f&&(u=f*e),h*e>s?h=s/e:s=h*e);i.minWidth=Math.min(u,s);i.minHeight=Math.min(f,h);i.maxWidth=s;i.maxHeight=h}t&&(l?(i.minLeft=Math.max(0,o.left),i.minTop=Math.max(0,o.top),i.maxLeft=Math.min(r.width,o.left+o.width)-i.width,i.maxTop=Math.min(r.height,o.top+o.height)-i.height):(i.minLeft=0,i.minTop=0,i.maxLeft=r.width-i.width,i.maxTop=r.height-i.height))},renderCropBox:function(){var t=this.options,i=this.container,n=this.cropBox;(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft);(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop);n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth);n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight);this.limitCropBox(!1,!0);n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft);n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop);n.oldLeft=n.left;n.oldTop=n.top;t.movable&&t.cropBoxMovable&&this.$face.data("action",n.width>=i.width&&n.height>=i.height?"move":"all");this.$cropBox.css({width:n.width,height:n.height,transform:s({translateX:n.left,translateY:n.top})});this.cropped&&this.limited&&this.limitCanvas(!0,!0);this.disabled||this.output()},output:function(){this.preview();this.completed&&this.trigger("crop",this.getData())}},fi={initPreview:function(){var t=this.crossOrigin,u=t?this.crossOriginUrl:this.url,i=document.createElement("img"),r;t&&(i.crossOrigin=t);i.src=u;r=n(i);this.$preview=n(this.options.preview);this.$clone2=r;this.$viewBox.html(r);this.$preview.each(function(i,r){var f=n(r),e=document.createElement("img");f.data("preview",{width:f.width(),height:f.height(),html:f.html()});t&&(e.crossOrigin=t);e.src=u;e.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"';f.html(e)})},resetPreview:function(){this.$preview.each(function(t,i){var u=n(i),r=u.data("preview");u.css({width:r.width,height:r.height}).html(r.html).removeData("preview")})},preview:function(){var t=this.image,f=this.canvas,i=this.cropBox,r=i.width,u=i.height,e=t.width,o=t.height,h=i.left-f.left-t.left,c=i.top-f.top-t.top;this.cropped&&!this.disabled&&(this.$clone2.css({width:e,height:o,transform:s(n.extend({translateX:-h,translateY:-c},t))}),this.$preview.each(function(i,f){var y=n(f),p=y.data("preview"),w=p.width,a=p.height,b=w,v=a,l=1;r&&(v=u*(l=w/r));u&&v>a&&(b=r*(l=a/u),v=a);y.css({width:b,height:v}).find("img").css({width:e*l,height:o*l,transform:s(n.extend({translateX:-h*l,translateY:-c*l},t))})}))}},ei={bind:function(){var i=this.$element,t=this.options,r=this.$cropper;n.isFunction(t.cropstart)&&i.on("cropstart",t.cropstart);n.isFunction(t.cropmove)&&i.on("cropmove",t.cropmove);n.isFunction(t.cropend)&&i.on("cropend",t.cropend);n.isFunction(t.crop)&&i.on("crop",t.crop);n.isFunction(t.zoom)&&i.on("zoom",t.zoom);r.on(p,u(this.cropStart,this));t.zoomable&&t.zoomOnWheel&&r.on("wheel mousewheel DOMMouseScroll",u(this.wheel,this));t.toggleDragModeOnDblclick&&r.on("dblclick",u(this.dblclick,this));n(document).on(w,this.onCropMove=u(this.cropMove,this)).on(b,this.onCropEnd=u(this.cropEnd,this));t.responsive&&n(window).on("resize",this.onResize=u(this.resize,this))},unbind:function(){var i=this.$element,t=this.options,r=this.$cropper;n.isFunction(t.cropstart)&&i.off("cropstart",t.cropstart);n.isFunction(t.cropmove)&&i.off("cropmove",t.cropmove);n.isFunction(t.cropend)&&i.off("cropend",t.cropend);n.isFunction(t.crop)&&i.off("crop",t.crop);n.isFunction(t.zoom)&&i.off("zoom",t.zoom);r.off(p,this.cropStart);t.zoomable&&t.zoomOnWheel&&r.off("wheel mousewheel DOMMouseScroll",this.wheel);t.toggleDragModeOnDblclick&&r.off("dblclick",this.dblclick);n(document).off(w,this.onCropMove).off(b,this.onCropEnd);t.responsive&&n(window).off("resize",this.onResize)}},oi={resize:function(){var t=this.options,e=this.$container,i=this.container,o=Number(t.minContainerWidth)||200,s=Number(t.minContainerHeight)||100,r,u,f;this.disabled||i.width<=o||i.height<=s||(r=e.width()/i.width,(1!==r||e.height()!==i.height)&&(u=void 0,f=void 0,t.restore&&(u=this.getCanvasData(),f=this.getCropBoxData()),this.render(),t.restore&&(this.setCanvasData(n.each(u,function(n,t){u[n]=t*r})),this.setCropBoxData(n.each(f,function(n,t){f[n]=t*r})))))},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(this.$dragBox.hasClass("cropper-crop")?"move":"crop")},wheel:function(n){var r=this,t=n.originalEvent||n,u=Number(this.options.wheelZoomRatio)||.1,i;this.disabled||(n.preventDefault(),this.wheeling)||(this.wheeling=!0,setTimeout(function(){r.wheeling=!1},50),i=1,t.deltaY?i=t.deltaY>0?1:-1:t.wheelDelta?i=-t.wheelDelta/120:t.detail&&(i=t.detail>0?1:-1),this.zoom(-i*u,n))},cropStart:function(t){if(!this.disabled){var f=this.options,u=this.pointers,i=t.originalEvent,r=void 0;i&&i.changedTouches?n.each(i.changedTouches,function(n,t){u[t.identifier]=h(t)}):u[i&&i.pointerId||0]=h(i||t);r=c(u).length>1&&f.zoomable&&f.zoomOnTouch?"zoom":n(t.target).data("action");pt.test(r)&&(this.trigger("cropstart",{originalEvent:i,action:r}).isDefaultPrevented()||(t.preventDefault(),this.action=r,this.cropping=!1,"crop"===r&&(this.cropping=!0,this.$dragBox.addClass("cropper-modal"))))}},cropMove:function(t){var u=this.action,r,i;!this.disabled&&u&&(r=this.pointers,i=t.originalEvent,t.preventDefault(),this.trigger("cropmove",{originalEvent:i,action:u}).isDefaultPrevented()||(i&&i.changedTouches?n.each(i.changedTouches,function(t,i){n.extend(r[i.identifier],h(i,!0))}):n.extend(r[i&&i.pointerId||0],h(i||t,!0)),this.change(t)))},cropEnd:function(t){if(!this.disabled){var u=this.action,r=this.pointers,i=t.originalEvent;i&&i.changedTouches?n.each(i.changedTouches,function(n,t){delete r[t.identifier]}):delete r[i&&i.pointerId||0];u&&(t.preventDefault(),c(r).length||(this.action=""),this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass("cropper-modal",this.cropped&&this.options.modal)),this.trigger("cropend",{originalEvent:i,action:u}))}}},si={change:function(t){var ft=this.options,tt=this.pointers,it=this.container,g=this.canvas,y=this.cropBox,h=this.action,e=ft.aspectRatio,s=y.left,o=y.top,f=y.width,u=y.height,d=s+f,w=o+u,b=0,v=0,k=it.width,p=it.height,l=!0,rt=void 0;!e&&t.shiftKey&&(e=f&&u?f/u:1);this.limited&&(b=y.minLeft,v=y.minTop,k=b+Math.min(it.width,g.width,g.left+g.width),p=v+Math.min(it.height,g.height,g.top+g.height));var nt=tt[c(tt)[0]],r={x:nt.endX-nt.startX,y:nt.endY-nt.startY},a=function(n){switch(n){case"e":d+r.x>k&&(r.x=k-d);break;case"w":s+r.x<b&&(r.x=b-s);break;case"n":o+r.y<v&&(r.y=v-o);break;case"s":w+r.y>p&&(r.y=p-w)}};switch(h){case"all":s+=r.x;o+=r.y;break;case"e":if(r.x>=0&&(d>=k||e&&(o<=v||w>=p))){l=!1;break}a("e");f+=r.x;e&&(u=f/e,o-=r.x/e/2);f<0&&(h="w",f=0);break;case"n":if(r.y<=0&&(o<=v||e&&(s<=b||d>=k))){l=!1;break}a("n");u-=r.y;o+=r.y;e&&(f=u*e,s+=r.y*e/2);u<0&&(h="s",u=0);break;case"w":if(r.x<=0&&(s<=b||e&&(o<=v||w>=p))){l=!1;break}a("w");f-=r.x;s+=r.x;e&&(u=f/e,o+=r.x/e/2);f<0&&(h="e",f=0);break;case"s":if(r.y>=0&&(w>=p||e&&(s<=b||d>=k))){l=!1;break}a("s");u+=r.y;e&&(f=u*e,s-=r.y*e/2);u<0&&(h="n",u=0);break;case"ne":if(e){if(r.y<=0&&(o<=v||d>=k)){l=!1;break}a("n");u-=r.y;o+=r.y;f=u*e}else a("n"),a("e"),r.x>=0?d<k?f+=r.x:r.y<=0&&o<=v&&(l=!1):f+=r.x,r.y<=0?o>v&&(u-=r.y,o+=r.y):(u-=r.y,o+=r.y);f<0&&u<0?(h="sw",u=0,f=0):f<0?(h="nw",f=0):u<0&&(h="se",u=0);break;case"nw":if(e){if(r.y<=0&&(o<=v||s<=b)){l=!1;break}a("n");u-=r.y;o+=r.y;f=u*e;s+=r.y*e}else a("n"),a("w"),r.x<=0?s>b?(f-=r.x,s+=r.x):r.y<=0&&o<=v&&(l=!1):(f-=r.x,s+=r.x),r.y<=0?o>v&&(u-=r.y,o+=r.y):(u-=r.y,o+=r.y);f<0&&u<0?(h="se",u=0,f=0):f<0?(h="ne",f=0):u<0&&(h="sw",u=0);break;case"sw":if(e){if(r.x<=0&&(s<=b||w>=p)){l=!1;break}a("w");f-=r.x;s+=r.x;u=f/e}else a("s"),a("w"),r.x<=0?s>b?(f-=r.x,s+=r.x):r.y>=0&&w>=p&&(l=!1):(f-=r.x,s+=r.x),r.y>=0?w<p&&(u+=r.y):u+=r.y;f<0&&u<0?(h="ne",u=0,f=0):f<0?(h="se",f=0):u<0&&(h="nw",u=0);break;case"se":if(e){if(r.x>=0&&(d>=k||w>=p)){l=!1;break}a("e");u=(f+=r.x)/e}else a("s"),a("e"),r.x>=0?d<k?f+=r.x:r.y>=0&&w>=p&&(l=!1):f+=r.x,r.y>=0?w<p&&(u+=r.y):u+=r.y;f<0&&u<0?(h="nw",u=0,f=0):f<0?(h="sw",f=0):u<0&&(h="ne",u=0);break;case"move":this.move(r.x,r.y);l=!1;break;case"zoom":this.zoom(ut(tt),t.originalEvent);l=!1;break;case"crop":if(!r.x||!r.y){l=!1;break}rt=this.$cropper.offset();s=nt.startX-rt.left;o=nt.startY-rt.top;f=y.minWidth;u=y.minHeight;r.x>0?h=r.y>0?"se":"ne":r.x<0&&(s-=f,h=r.y>0?"sw":"nw");r.y<0&&(o-=u);this.cropped||(this.$cropBox.removeClass(i),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}l&&(y.width=f,y.height=u,y.left=s,y.top=o,this.action=h,this.renderCropBox());n.each(tt,function(n,t){t.startX=t.endX;t.startY=t.endY})}},hi={crop:function(){this.ready&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass("cropper-modal"),this.$cropBox.removeClass(i)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.ready&&!this.disabled&&(this.image=n.extend({},this.initialImage),this.canvas=n.extend({},this.initialCanvas),this.cropBox=n.extend({},this.initialCropBox),this.renderCanvas(),this.cropped&&this.renderCropBox())},clear:function(){this.cropped&&!this.disabled&&(n.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),this.$dragBox.removeClass("cropper-modal"),this.$cropBox.addClass(i))},replace:function(n,t){!this.disabled&&n&&(this.isImg&&this.$element.attr("src",n),t?(this.url=n,this.$clone.attr("src",n),this.ready&&this.$preview.find("img").add(this.$clone2).attr("src",n)):(this.isImg&&(this.replaced=!0),this.options.data=null,this.load(n)))},enable:function(){this.ready&&(this.disabled=!1,this.$cropper.removeClass("cropper-disabled"))},disable:function(){this.ready&&(this.disabled=!0,this.$cropper.addClass("cropper-disabled"))},destroy:function(){var n=this.$element;this.loaded?(this.isImg&&this.replaced&&n.attr("src",this.originalUrl),this.unbuild(),n.removeClass(i)):this.isImg?n.off("load",this.start):this.$clone&&this.$clone.remove();n.removeData("cropper")},move:function(n,t){var i=this.canvas,r=i.left,u=i.top;this.moveTo(o(n)?n:r+Number(n),o(t)?t:u+Number(t))},moveTo:function(n,i){var u=this.canvas,r=!1;o(i)&&(i=n);n=Number(n);i=Number(i);this.ready&&!this.disabled&&this.options.movable&&(t(n)&&(u.left=n,r=!0),t(i)&&(u.top=i,r=!0),r&&this.renderCanvas(!0))},zoom:function(n,t){var i=this.canvas;n=(n=Number(n))<0?1/(1-n):1+n;this.zoomTo(i.width*n/i.naturalWidth,t)},zoomTo:function(n,t){var v=this.options,e=this.pointers,i=this.canvas,u=i.width,o=i.height,s=i.naturalWidth,y=i.naturalHeight,l,a;if((n=Number(n))>=0&&this.ready&&!this.disabled&&v.zoomable){var f=s*n,h=y*n,r=void 0;if(t&&(r=t.originalEvent),this.trigger("zoom",{originalEvent:r,oldRatio:u/s,ratio:f/s}).isDefaultPrevented())return;r?(l=this.$cropper.offset(),a=e&&c(e).length?ft(e):{pageX:t.pageX||r.pageX||0,pageY:t.pageY||r.pageY||0},i.left-=(f-u)*((a.pageX-l.left-i.left)/u),i.top-=(h-o)*((a.pageY-l.top-i.top)/o)):(i.left-=(f-u)/2,i.top-=(h-o)/2);i.width=f;i.height=h;this.renderCanvas(!0)}},rotate:function(n){this.rotateTo((this.image.rotate||0)+Number(n))},rotateTo:function(n){t(n=Number(n))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.image.rotate=n%360,this.renderCanvas(!0,!0))},scaleX:function(n){var i=this.image.scaleY;this.scale(n,t(i)?i:1)},scaleY:function(n){var i=this.image.scaleX;this.scale(t(i)?i:1,n)},scale:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,u=this.image,r=!1;n=Number(n);i=Number(i);this.ready&&!this.disabled&&this.options.scalable&&(t(n)&&(u.scaleX=n,r=!0),t(i)&&(u.scaleY=i,r=!0),r&&this.renderCanvas(!0,!0))},getData:function(){var o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],u=this.options,i=this.image,f=this.canvas,r=this.cropBox,t=void 0,e;return this.ready&&this.cropped?(t={x:r.left-f.left,y:r.top-f.top,width:r.width,height:r.height},e=i.width/i.naturalWidth,n.each(t,function(n,i){i/=e;t[n]=o?Math.round(i):i})):t={x:0,y:0,width:0,height:0},u.rotatable&&(t.rotate=i.rotate||0),u.scalable&&(t.scaleX=i.scaleX||1,t.scaleY=i.scaleY||1),t},setData:function(i){var o=this.options,r=this.image,s=this.canvas,u={},f,e;(n.isFunction(i)&&(i=i.call(this.element)),this.ready&&!this.disabled&&n.isPlainObject(i))&&(f=!1,o.rotatable&&t(i.rotate)&&i.rotate!==r.rotate&&(r.rotate=i.rotate,f=!0),o.scalable&&(t(i.scaleX)&&i.scaleX!==r.scaleX&&(r.scaleX=i.scaleX,f=!0),t(i.scaleY)&&i.scaleY!==r.scaleY&&(r.scaleY=i.scaleY,f=!0)),f&&this.renderCanvas(!0,!0),e=r.width/r.naturalWidth,t(i.x)&&(u.left=i.x*e+s.left),t(i.y)&&(u.top=i.y*e+s.top),t(i.width)&&(u.width=i.width*e),t(i.height)&&(u.height=i.height*e),this.setCropBoxData(u))},getContainerData:function(){return this.ready?n.extend({},this.container):{}},getImageData:function(){return this.loaded?n.extend({},this.image):{}},getCanvasData:function(){var i=this.canvas,t={};return this.ready&&n.each(["left","top","width","height","naturalWidth","naturalHeight"],function(n,r){t[r]=i[r]}),t},setCanvasData:function(i){var r=this.canvas,u=r.aspectRatio;n.isFunction(i)&&(i=i.call(this.$element));this.ready&&!this.disabled&&n.isPlainObject(i)&&(t(i.left)&&(r.left=i.left),t(i.top)&&(r.top=i.top),t(i.width)?(r.width=i.width,r.height=i.width/u):t(i.height)&&(r.height=i.height,r.width=i.height*u),this.renderCanvas(!0))},getCropBoxData:function(){var n=this.cropBox;return this.ready&&this.cropped?{left:n.left,top:n.top,width:n.width,height:n.height}:{}},setCropBoxData:function(i){var r=this.cropBox,u=this.options.aspectRatio,f=void 0,e=void 0;n.isFunction(i)&&(i=i.call(this.$element));this.ready&&this.cropped&&!this.disabled&&n.isPlainObject(i)&&(t(i.left)&&(r.left=i.left),t(i.top)&&(r.top=i.top),t(i.width)&&i.width!==r.width&&(f=!0,r.width=i.width),t(i.height)&&i.height!==r.height&&(e=!0,r.height=i.height),u&&(f?r.height=r.width/u:e&&(r.width=r.height*u)),this.renderCropBox())},getCroppedCanvas:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},ut,s,l,u,rt,p;if(!this.ready||!window.HTMLCanvasElement)return null;if(ut=this.canvas,s=ot(this.$clone[0],this.image,ut,t),!this.cropped)return s;var w=this.getData(),lt=w.x,at=w.y,o=w.width,h=w.height,it=o/h,ft=e({aspectRatio:it,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),et=e({aspectRatio:it,width:t.minWidth||0,height:t.minHeight||0}),st=e({aspectRatio:it,width:t.width||o,height:t.height||h}),c=st.width,b=st.height;c=Math.min(ft.width,Math.max(et.width,c));b=Math.min(ft.height,Math.max(et.height,b));l=document.createElement("canvas");u=l.getContext("2d");l.width=f(c);l.height=f(b);u.fillStyle=t.fillColor||"transparent";u.fillRect(0,0,c,b);var ht=t.imageSmoothingEnabled,yt=void 0===ht||ht,ct=t.imageSmoothingQuality;u.imageSmoothingEnabled=yt;ct&&(u.imageSmoothingQuality=ct);var k=s.width,d=s.height,i=lt,r=at,a=void 0,g=void 0,nt=void 0,tt=void 0,v=void 0,y=void 0;return i<=-o||i>k?(i=0,a=0,nt=0,v=0):i<=0?(nt=-i,i=0,v=a=Math.min(k,o+i)):i<=k&&(nt=0,v=a=Math.min(o,k-i)),a<=0||r<=-h||r>d?(r=0,g=0,tt=0,y=0):r<=0?(tt=-r,r=0,y=g=Math.min(d,h+r)):r<=d&&(tt=0,y=g=Math.min(h,d-r)),rt=[i,r,a,g],v>0&&y>0&&(p=c/o,rt.push(nt*p,tt*p,v*p,y*p)),u.drawImage.apply(u,[s].concat(vt(n.map(rt,function(n){return Math.floor(f(n))})))),l},setAspectRatio:function(n){var t=this.options;this.disabled||o(n)||(t.aspectRatio=Math.max(0,n)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox()))},setDragMode:function(n){var r=this.options,t=void 0,i=void 0;this.loaded&&!this.disabled&&(t="crop"===n,i=r.movable&&"move"===n,n=t||i?n:"none",this.$dragBox.data("action",n).toggleClass("cropper-crop",t).toggleClass("cropper-move",i),r.cropBoxMovable||this.$face.data("action",n).toggleClass("cropper-crop",t).toggleClass("cropper-move",i))}},ci=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),l=function(){function t(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(yt(this,t),!i||!kt.test(i.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=i;this.$element=n(i);this.options=n.extend({},k,n.isPlainObject(r)&&r);this.completed=!1;this.cropped=!1;this.disabled=!1;this.isImg=!1;this.limited=!1;this.loaded=!1;this.ready=!1;this.replaced=!1;this.wheeling=!1;this.originalUrl="";this.canvas=null;this.cropBox=null;this.pointers={};this.init()}return ci(t,[{key:"init",value:function(){var t=this.$element,n=void 0;if(t.is("img")){if(this.isImg=!0,n=t.attr("src")||"",this.originalUrl=n,!n)return;n=t.prop("src")}else t.is("canvas")&&window.HTMLCanvasElement&&(n=t[0].toDataURL());this.load(n)}},{key:"trigger",value:function(t,i){var r=n.Event(t,i);return this.$element.trigger(r),r}},{key:"load",value:function(n){var u=this,i,r,t;n&&(this.url=n,this.image={},i=this.$element,r=this.options,r.checkOrientation&&window.ArrayBuffer?wt.test(n)?bt.test(n)?this.read(ht(n)):this.clone():(t=new XMLHttpRequest,t.onerror=function(){u.clone()},t.onload=function(){u.read(t.response)},r.checkCrossOrigin&&v(n)&&i.prop("crossOrigin")&&(n=y(n)),t.open("get",n),t.responseType="arraybuffer",t.withCredentials="use-credentials"===i.prop("crossOrigin"),t.send()):this.clone())}},{key:"read",value:function(n){var r=this.options,i=this.image,u=lt(n),f=0,e=1,o=1,t;u>1&&(this.url=ct(n,"image/jpeg"),t=at(u),f=t.rotate,e=t.scaleX,o=t.scaleY);r.rotatable&&(i.rotate=f);r.scalable&&(i.scaleX=e,i.scaleY=o);this.clone()}},{key:"clone",value:function(){var f=this.$element,o=this.options,i=this.url,t="",r=void 0,u,e;o.checkCrossOrigin&&v(i)&&((t=f.prop("crossOrigin"))?r=i:(t="anonymous",r=y(i)));this.crossOrigin=t;this.crossOriginUrl=r;u=document.createElement("img");t&&(u.crossOrigin=t);u.src=r||i;e=n(u);this.$clone=e;this.isImg?this.element.complete?this.start():f.one("load",n.proxy(this.start,this)):e.one("load",n.proxy(this.start,this)).one("error",n.proxy(this.stop,this)).addClass("cropper-hide").insertAfter(f)}},{key:"start",value:function(){var t=this,i=this.$clone,r=this.$element;this.isImg||(i.off("error",this.stop),r=i);rt(r[0],function(i,r){n.extend(t.image,{naturalWidth:i,naturalHeight:r,aspectRatio:i/r});t.loaded=!0;t.build()})}},{key:"stop",value:function(){this.$clone.remove();this.$clone=null}},{key:"build",value:function(){var f=this;if(this.loaded){this.ready&&this.unbuild();var e=this.$element,t=this.options,s=this.$clone,r=n('<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"><\/div><\/div><div class="cropper-drag-box"><\/div><div class="cropper-crop-box"><span class="cropper-view-box"><\/span><span class="cropper-dashed dashed-h"><\/span><span class="cropper-dashed dashed-v"><\/span><span class="cropper-center"><\/span><span class="cropper-face"><\/span><span class="cropper-line line-e" data-action="e"><\/span><span class="cropper-line line-n" data-action="n"><\/span><span class="cropper-line line-w" data-action="w"><\/span><span class="cropper-line line-s" data-action="s"><\/span><span class="cropper-point point-e" data-action="e"><\/span><span class="cropper-point point-n" data-action="n"><\/span><span class="cropper-point point-w" data-action="w"><\/span><span class="cropper-point point-s" data-action="s"><\/span><span class="cropper-point point-ne" data-action="ne"><\/span><span class="cropper-point point-nw" data-action="nw"><\/span><span class="cropper-point point-sw" data-action="sw"><\/span><span class="cropper-point point-se" data-action="se"><\/span><\/div><\/div>'),u=r.find(".cropper-crop-box"),o=u.find(".cropper-face");this.$container=e.parent();this.$cropper=r;this.$canvas=r.find(".cropper-canvas").append(s);this.$dragBox=r.find(".cropper-drag-box");this.$cropBox=u;this.$viewBox=r.find(".cropper-view-box");this.$face=o;e.addClass(i).after(r);this.isImg||s.removeClass("cropper-hide");this.initPreview();this.bind();t.aspectRatio=Math.max(0,t.aspectRatio)||NaN;t.viewMode=Math.max(0,Math.min(3,Math.round(t.viewMode)))||0;this.cropped=t.autoCrop;t.autoCrop?t.modal&&this.$dragBox.addClass("cropper-modal"):u.addClass(i);t.guides||u.find(".cropper-dashed").addClass(i);t.center||u.find(".cropper-center").addClass(i);t.cropBoxMovable&&o.addClass("cropper-move").data("action","all");t.highlight||o.addClass("cropper-invisible");t.background&&r.addClass("cropper-bg");t.cropBoxResizable||u.find(".cropper-line,.cropper-point").addClass(i);this.setDragMode(t.dragMode);this.render();this.ready=!0;this.setData(t.data);this.completing=setTimeout(function(){n.isFunction(t.ready)&&e.one("ready",t.ready);f.trigger("ready");f.trigger("crop",f.getData());f.completed=!0},0)}}},{key:"unbuild",value:function(){this.ready&&(this.completed||clearTimeout(this.completing),this.ready=!1,this.completed=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.unbind(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)}}],[{key:"setDefaults",value:function(t){n.extend(k,n.isPlainObject(t)&&t)}}]),t}();(n.extend&&n.extend(l.prototype,ui,fi,ei,oi,si,hi),n.fn)&&(nt=n.fn.cropper,n.fn.cropper=function(t){for(var r,u=arguments.length,f=Array(u>1?u-1:0),i=1;i<u;i++)f[i-1]=arguments[i];return r=void 0,this.each(function(i,u){var o=n(u),e=o.data("cropper"),h,s;if(!e){if(/destroy/.test(t))return;h=n.extend({},o.data(),n.isPlainObject(t)&&t);e=new l(u,h);o.data("cropper",e)}it(t)&&(s=e[t],n.isFunction(s)&&(r=s.apply(e,f)))}),o(r)?this:r},n.fn.cropper.Constructor=l,n.fn.cropper.setDefaults=l.setDefaults,n.fn.cropper.noConflict=function(){return n.fn.cropper=nt,this})});