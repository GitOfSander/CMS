var id,lineId,feeId,shippingMethodId,recovery,backUp,productId,validateBilling,validateShipping,validateShippingMethod,validateFee,validateProduct,tax;$(document).ready(function(){$("#navigation #navOrders").addClass("active").parents("li").addClass("active").addClass("open").find(".sub-menu").slideDown();id=$("#id").val()!==""?$("#id").val():0;$.fn.modal.Constructor.prototype.enforceFocus=$.noop;$.ajax({url:"/spine-api/order",dataType:"json",type:"get",data:{id:id},contentType:"application/json;",success:function(n){return backUp=n,fillItem(n),id!==0&&$("#title span").html(n.item.orderNumber),$("#main-wrapper").fadeIn(500),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;t.redirect!==null&&typeof t.redirect!="undefined"&&(location.href=t.redirect)}return!0}});$("#rootwizard").bootstrapWizard({tabClass:"nav nav-tabs",onTabShow:function(){$("#list .checkbox input, #shippings .checkbox input, #fees .checkbox input").each(function(){var n=$(this).prop("checked",!1);$.uniform.update(n)});$("#deleteLines").fadeOut("500")}});$("form#shippingMethod").find("#taxable").uniform();$("#modalGeneral").on("shown.bs.modal",function(){fillGeneralModal()});$("#modalShipping").on("shown.bs.modal",function(){fillShippingModal()});$("#modalBilling").on("shown.bs.modal",function(){fillBillingModal()});setBillingValidation();setShippingValidation();setShippingMethodValidation();setFeeValidation();setProductValidation();$("#saveGeneral").on("click",function(){localSaveGeneral()});$("#saveFee").on("click",function(){localSaveFee(feeId)});$("#saveProduct").on("click",function(){localSaveProduct(lineId,productId)});$("#saveShippingMethod").on("click",function(){localSaveShippingMethod(shippingMethodId)});$("#saveShipping").on("click",function(){localSaveShipping()});$("#saveBilling").on("click",function(){localSaveBilling()});$("#copyBilling").on("click",function(){copyBilling()});$("select#status").on("change",function(){$(this).val()==="credit"?$("input#refInvoiceNumber").parents("#refInvoiceNumberHolder").show():$("input#refInvoiceNumber").val("").parents("#refInvoiceNumberHolder").hide()});$("#openShippingMethodModal").on("click",function(){shippingMethodId=0;fillShippingMethodModal(shippingMethodId);$("#modalShippingMethod").modal("show")});$("#openFeeModal").on("click",function(){feeId=0;fillFeeModal(feeId);$("#modalFee").modal("show")});$("#openProductModal").on("click",function(){lineId=0;fillProductModal(lineId);$("#modalProduct").modal("show")});$("#deleteLines").on("click",function(){createArrayList()})});createArrayList=function(){var n={},r=[],t,i;$("#shippings .checkbox input").each(function(){$(this).is(":checked")&&r.push($(this).parents("tr").attr("data-id"))});n.shippings=r;t=[];$("#fees .checkbox input").each(function(){$(this).is(":checked")&&t.push($(this).parents("tr").attr("data-id"))});n.fees=t;i=[];$("#list .checkbox input").each(function(){$(this).is(":checked")&&i.push($(this).parents("tr").attr("data-id"))});n.lines=i;deleteSelection(n)};deleteSelection=function(n){$.ajax({url:"/spine-api/delete-order-fees-shippings-lines",dataType:"json",type:"post",data:n,success:function(t){var i=t.value;return toastr[i.messageType](i.message),removeSelection(n),updateTotalPrices(),$("#deleteLines").fadeOut("500"),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})};removeSelection=function(n){removeShippingListItems(n.shippings);removeFeeListItems(n.fees);removeListItems(n.lines);recovery=$.extend(!0,{},backUp)};removeShippingListItems=function(n){$.each(n,function(n,t){backUp.shippings=$.grep(backUp.shippings,function(n){return n.id!==t});$('#shippings tr[data-id="'+t+'"]').remove()});backUp.shippings.length===0&&$("#shippings #noData").show()};removeFeeListItems=function(n){$.each(n,function(n,t){backUp.fees=$.grep(backUp.fees,function(n){return n.id!==t});$('#fees tr[data-id="'+t+'"]').remove()});backUp.fees.length===0&&$("#fees #noData").show()};removeListItems=function(n){$.each(n,function(n,t){backUp.lines=$.grep(backUp.lines,function(n){return n.id!==t});$('#list tr[data-id="'+t+'"]').remove()});backUp.lines.length===0&&$("#list #noData").show()};updateTotalPrices=function(){tax=parseFloat(0);var n=getTotalFeePrice(backUp.fees,backUp.digitsAfterDecimal),i=getTotalLinePrice(backUp.lines,backUp.digitsAfterDecimal),t=getTotalShippingPrice(backUp.shippings,backUp.lines,backUp.fees,backUp.digitsAfterDecimal),r=getTotalPrice(t,i,n);$("#totalShipping").html(backUp.priceFormat.replace("price",t));$("#totalFee").html(backUp.priceFormat.replace("price",n));$("#totalTax").html(backUp.priceFormat.replace("price",roundNumber(tax,backUp.digitsAfterDecimal)));$("#totalPrice").html(backUp.priceFormat.replace("price",r))};fillGeneralModal=function(){var n="form#general",t=backUp.item,i=getDate(new Date(t.createdDate));$(n).find("#date").datepicker({orientation:"top auto",autoclose:!0}).datepicker("update",i);$(n).find("#time").timepicker({defaultTime:new Date(t.createdDate)});$(n).find("#status").val(t.status);t.status==="completed"||t.status==="credit"?($(n).find("#invoiceNumber").val(t.invoiceNumber),$(n).find("#invoiceNumberHolder").show()):($(n).find("#invoiceNumber").val(""),$(n).find("#invoiceNumberHolder").hide());t.status==="credit"?($(n).find("#refInvoiceNumber").val(t.refInvoiceNumber),$(n).find("#refInvoiceNumberHolder").show()):($(n).find("#refInvoiceNumber").val(""),$(n).find("#refInvoiceNumberHolder").hide());$(n).find("#transactionId").val(t.transactionId);$(n).find("#note").val(t.note)};fillShippingModal=function(){var n="form#shipping",t=backUp.item;$(n).find("#company").val(t.shippingCompany);$(n).find("#firstName").val(t.shippingFirstName);$(n).find("#lastName").val(t.shippingLastName);$(n).find("#addressLine1").val(t.shippingAddressLine1);$(n).find("#addressLine2").val(t.shippingAddressLine2);$(n).find("#zipCode").val(t.shippingZipCode);$(n).find("#city").val(t.shippingCity);$(n).find("#country").val(t.billingCountry.toLowerCase());$(n).find("#state").val(t.shippingState);validateShipping.resetForm()};fillBillingModal=function(){var n="form#billing",t=backUp.item;$(n).find("#company").val(t.billingCompany);$(n).find("#vat").val(t.billingVatNumber);$(n).find("#firstName").val(t.billingFirstName);$(n).find("#lastName").val(t.billingLastName);$(n).find("#email").val(t.billingEmail);$(n).find("#phoneNumber").val(t.billingPhoneNumber);$(n).find("#addressLine1").val(t.billingAddressLine1);$(n).find("#addressLine2").val(t.billingAddressLine2);$(n).find("#zipCode").val(t.billingZipCode);$(n).find("#city").val(t.billingCity);$(n).find("#country").val(t.billingCountry.toLowerCase());$(n).find("#state").val(t.billingState);validateBilling.resetForm()};fillFeeModal=function(n){var i="form#fee",t;n!==0?(t=t=backUp.fees.filter(t=>t.id===n)[0],$(i).find("#name").val(t.name),$(i).find("#price").val(roundNumber(t.price,backUp.digitsAfterDecimal)),$(i).find("#taxRate").val(roundNumber(t.taxRate,backUp.digitsAfterDecimal))):$(i).find("input[type=text]").val("");validateFee.resetForm()};fillShippingMethodModal=function(n){var t="form#shippingMethod",i,r;n!==0?(i=backUp.shippings.filter(t=>t.id===n)[0],$(t).find("#name").val(i.name),$(t).find("#price").val(roundNumber(i.price,backUp.digitsAfterDecimal)),r=$(t).find("#taxable").prop("checked",i.taxable),$.uniform.update(r)):($(t).find("input[type=text]").val(""),$(t).find("input[type=checkbox]").prop("checked",!0));validateShippingMethod.resetForm()};fillProductModal=function(n){var i="form#product",t;$("select#product").hasClass("select2-hidden-accessible")&&$("select#product").select2("destroy");n!==0?($("select#product").parents(".form-group").addClass("hidden"),t=t=backUp.lines.filter(t=>t.id===n)[0],$(i).find("#name").val(t.name),$(i).find("#price").val(roundNumber(t.price,backUp.digitsAfterDecimal)),$(i).find("#discount").val(roundNumber(t.discount,backUp.digitsAfterDecimal)),$(i).find("#quantity").val(t.quantity),$(i).find("#tax").val(roundNumber(t.tax,backUp.digitsAfterDecimal)),productId=t.productId):($("select#product").select2({maximumSelectionLength:1,allowClear:!0,tabindex:!1,placeholder:"Select a product",ajax:{delay:250,url:"/spine-api/products-by-name",dataType:"json",data:function(n){return{term:n.term}},processResults:function(n){return n.value}}}).on("select2:select",function(n){productId=n.params.data.id}).on("select2:unselect",function(){productId=0}).val("").trigger("change").parents(".form-group").removeClass("hidden"),productId=0,$(i).find("input[type=text]").val(""));validateProduct.resetForm()};setBillingValidation=function(){validateBilling=$("form#billing").validate({ignore:[],errorPlacement:function(n,t){t.parent(".tags-input").length?n.appendTo(t.parent()):t.parent(".input-group").length?n.insertAfter(t.parent()):n.insertAfter(t)},rules:{company:{maxlength:255},vat:{maxlength:255},firstName:{required:!0,maxlength:255},lastName:{required:!0,maxlength:255},email:{email:!0,maxlength:255},phoneNumber:{phoneno:!0,maxlength:255},zipCode:{required:!0,maxlength:32},city:{required:!0,maxlength:100},country:{required:!0,maxlength:100},state:{maxlength:100},addressLine1:{required:!0,maxlength:255},addressLine2:{maxlength:255}},messages:{firstName:{required:"First name is required."},lastName:{required:"Last name is required."},zipCode:{required:"Zip code is required."},city:{required:"City is required."},country:{required:"Country is required."},addressLine1:{required:"Address is required."}},onkeyup:function(n){$(n).valid()}})};setShippingValidation=function(){validateShipping=$("form#shipping").validate({ignore:[],errorPlacement:function(n,t){t.parent(".tags-input").length?n.appendTo(t.parent()):t.parent(".input-group").length?n.insertAfter(t.parent()):n.insertAfter(t)},rules:{company:{maxlength:255},firstName:{required:!0,maxlength:255},lastName:{required:!0,maxlength:255},zipCode:{required:!0,maxlength:32},city:{required:!0,maxlength:100},country:{required:!0,maxlength:100},state:{maxlength:100},addressLine1:{required:!0,maxlength:255},addressLine2:{maxlength:255}},messages:{firstName:{required:"First name is required."},lastName:{required:"Last name is required."},zipCode:{required:"Zip code is required."},city:{required:"City is required."},country:{required:"Country is required."},addressLine1:{required:"Address is required."}},onkeyup:function(n){$(n).valid()}})};setShippingMethodValidation=function(){validateShippingMethod=$("form#shippingMethod").validate({ignore:[],errorPlacement:function(n,t){t.parent(".tags-input").length?n.appendTo(t.parent()):t.parent(".input-group").length?n.insertAfter(t.parent()):n.insertAfter(t)},rules:{name:{required:!0,maxlength:255},price:{required:!0,decimal:!0}},messages:{name:{required:"Name is required."},price:{required:"Price is required."}},onkeyup:function(n){$(n).valid()}})};setFeeValidation=function(){validateFee=$("form#fee").validate({ignore:[],errorPlacement:function(n,t){t.parent(".tags-input").length?n.appendTo(t.parent()):t.parent(".input-group").length?n.insertAfter(t.parent()):n.insertAfter(t)},rules:{name:{required:!0,maxlength:255},price:{required:!0,decimal:!0},taxRate:{required:!0,decimal:!0}},messages:{name:{required:"Name is required."},price:{required:"Price is required."},taxRate:{required:"Tax rate is required."}},onkeyup:function(n){$(n).valid()}})};setProductValidation=function(){validateProduct=$("form#product").validate({ignore:[],errorPlacement:function(n,t){t.parent(".tags-input").length?n.appendTo(t.parent()):t.parent(".input-group").length?n.insertAfter(t.parent()):n.insertAfter(t)},rules:{name:{required:!0,maxlength:255},price:{required:!0,decimal:!0},discount:{decimal:!0},quantity:{required:!0,digits:!0},tax:{required:!0,decimal:!0}},messages:{name:{required:"Name is required."},price:{required:"Price is required."},quantity:{required:"Quantity is required."},tax:{required:"Tax rate is required."}},onkeyup:function(n){$(n).valid()}})};copyBilling=function(){var n="form#shipping",t=backUp.item;$(n).find("#company").val(t.billingCompany);$(n).find("#firstName").val(t.billingFirstName);$(n).find("#lastName").val(t.billingLastName);$(n).find("#addressLine1").val(t.billingAddressLine1);$(n).find("#addressLine2").val(t.billingAddressLine2);$(n).find("#zipCode").val(t.billingZipCode);$(n).find("#city").val(t.billingCity);t.billingCountry!==""?$(n).find("#country").val(t.billingCountry):$(n).find("#country option:first-of-type").prop("selected","selected");$(n).find("#state").val(t.billingState);$(n).valid()};localSaveGeneral=function(){recovery=$.extend(!0,{},backUp);var n=backUp.item,t="form#general";n.createdDate=$(t).find("#date").val()+" "+$(t).find("#time").val();n.status=$(t).find("#status").val();n.invoiceNumber=$(t).find("#invoiceNumber").val();n.refInvoiceNumber=$(t).find("#refInvoiceNumber").val();n.transactionId=$(t).find("#transactionId").val();n.note=$(t).find("#note").val();saveOrder(n)};localSaveShipping=function(){recovery=$.extend(!0,{},backUp);var n=backUp.item,t="form#shipping",i=$(t).valid();if(!i)return validateShipping.focusInvalid(),!1;n.shippingCompany=$(t).find("#company").val();n.shippingFirstName=$(t).find("#firstName").val();n.shippingLastName=$(t).find("#lastName").val();n.shippingAddressLine1=$(t).find("#addressLine1").val();n.shippingAddressLine2=$(t).find("#addressLine2").val();n.shippingZipCode=$(t).find("#zipCode").val();n.shippingCity=$(t).find("#city").val();n.shippingCountry=$(t).find("#country").val();n.shippingState=$(t).find("#state").val();saveOrder(n)};localSaveBilling=function(){recovery=$.extend(!0,{},backUp);var n=backUp.item,t="form#billing",i=$(t).valid();if(!i)return validateBilling.focusInvalid(),!1;n.billingCompany=$(t).find("#company").val();n.billingVatNumber=$(t).find("#vat").val();n.billingFirstName=$(t).find("#firstName").val();n.billingLastName=$(t).find("#lastName").val();n.billingEmail=$(t).find("#email").val();n.billingPhoneNumber=$(t).find("#phoneNumber").val();n.billingAddressLine1=$(t).find("#addressLine1").val();n.billingAddressLine2=$(t).find("#addressLine2").val();n.billingZipCode=$(t).find("#zipCode").val();n.billingCity=$(t).find("#city").val();n.billingCountry=$(t).find("#country").val();n.billingState=$(t).find("#state").val();saveOrder(n)};localSaveProduct=function(n,t){recovery=$.extend(!0,{},backUp);var i=n!==0?backUp.lines.filter(t=>t.id==n)[0]:{id:0,productId:t},r="form#product",u=$(r).valid();if(!u)return validateProduct.focusInvalid(),!1;i.name=$(r).find("#name").val();i.price=$(r).find("#price").val();i.discount=$(r).find("#discount").val()===""?0:$(r).find("#discount").val();i.quantity=$(r).find("#quantity").val();i.tax=$(r).find("#tax").val();i.total=i.price*i.quantity;saveProduct(i,n,t)};localSaveShippingMethod=function(n){recovery=$.extend(!0,{},backUp);var t=n!==0?backUp.shippings.filter(t=>t.id==n)[0]:{id:0,orderId:id},i="form#shippingMethod",r=$(i).valid();if(!r)return validateShippingMethod.focusInvalid(),!1;t.name=$(i).find("#name").val();t.price=$(i).find("#price").val();t.taxable=$(i).find("#taxable").is(":checked");saveShippingMethod(t,n)};localSaveFee=function(n){recovery=$.extend(!0,{},backUp);var t=n!==0?backUp.fees.filter(t=>t.id==n)[0]:{id:0,orderId:id},i="form#fee",r=$(i).valid();if(!r)return validateFee.focusInvalid(),!1;t.name=$(i).find("#name").val();t.price=$(i).find("#price").val();t.taxRate=$(i).find("#taxRate").val();saveFee(t,n)};saveOrder=function(n){$.ajax({url:"/spine-api/order",dataType:"json",type:"post",contentType:"application/json;",data:JSON.stringify(n),success:function(t){var i=t.value;return toastr[i.messageType](i.message),backUp.item=i.item,recovery=$.extend(!0,{},backUp),fillGeneral(n),fillBilling(n),fillShipping(n),$("#modalBilling, #modalShipping, #modalGeneral").modal("hide"),!0},error:function(n){if(backUp=$.extend(!0,{},recovery),n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})};saveShippingMethod=function(n,t){$.ajax({url:"/spine-api/order-shipping",dataType:"json",type:"post",contentType:"application/json;",data:JSON.stringify(n),success:function(i){var r=i.value;return toastr[r.messageType](r.message),t!==0?backUp.shippings.filter(n=>n.id==t)[0]=n:backUp.shippings.push(r.item),recovery=$.extend(!0,{},backUp),$("#shippings").empty(),createShippingList(backUp),updateTotalPrices(),$("#modalShippingMethod").modal("hide"),!0},error:function(n){if(backUp=$.extend(!0,{},recovery),n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})};saveFee=function(n,t){$.ajax({url:"/spine-api/order-fee",dataType:"json",type:"post",contentType:"application/json;",data:JSON.stringify(n),success:function(i){var r=i.value;return toastr[r.messageType](r.message),t!==0?backUp.fees.filter(n=>n.id==t)[0]=n:backUp.fees.push(r.item),recovery=$.extend(!0,{},backUp),$("#fees").empty(),createFeeList(backUp),updateTotalPrices(),$("#modalFee").modal("hide"),!0},error:function(n){if(backUp=$.extend(!0,{},recovery),n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})};saveProduct=function(n,t,i){$.ajax({url:"/spine-api/order-line",dataType:"json",type:"post",contentType:"application/json;",data:JSON.stringify({id:t,productId:i,orderId:id,name:n.name,price:n.price,discount:n.discount,quantity:n.quantity,taxRate:n.tax}),success:function(i){var r=i.value;return toastr[r.messageType](r.message),t!==0?backUp.lines.filter(n=>n.id==t)[0]=n:backUp.lines.push({id:r.item.id,productId:r.item.productId,name:r.item.name,discount:r.item.discount,price:r.item.price,product:r.item.productId!==0?"/products/edit/"+r.item.productId:"",quantity:r.item.quantity,refunds:[],tax:r.item.taxRate,total:r.item.price*r.item.quantity}),recovery=$.extend(!0,{},backUp),$("#list").empty(),createList(backUp),updateTotalPrices(),$("#modalProduct").modal("hide"),!0},error:function(n){if(backUp=$.extend(!0,{},recovery),n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})};fillItem=function(n){var t=n.item;fillGeneral(t);fillBilling(t);fillShipping(t);$("#totalShipping").html(n.priceFormat.replace("price",roundNumber(n.totalShipping,n.digitsAfterDecimal)));$("#totalFee").html(n.priceFormat.replace("price",roundNumber(n.totalFee,n.digitsAfterDecimal)));$("#totalTax").html(n.priceFormat.replace("price",roundNumber(n.totalTax,n.digitsAfterDecimal)));$("#totalPrice").html(n.priceFormat.replace("price",roundNumber(n.total,n.digitsAfterDecimal)));createList(n);createShippingList(n);createFeeList(n);addCustomValidations(n)};addCustomValidations=function(n){jQuery.validator.addMethod("phoneno",function(n,t){return n=n.replace(/\s+/g,""),this.optional(t)||n.length>9&&n.match(/^((\+[1-9]{1,4}[ \-]*)|(\([0-9]{2,3}\)[ \-]*)|([0-9]{2,4})[ \-]*)*?[0-9]{3,4}?[ \-]*[0-9]{3,4}?$/)},"This is not a valid phone number.");jQuery.validator.addMethod("decimal",function(t,i){return this.optional(i)||t.match(new RegExp("^\\d{0,14}(?:\\.\\d{0,"+n.digitsAfterDecimal+"})?$"))},"Please enter only digits and max "+n.digitsAfterDecimal+" digits after decimal and 14 before.")};fillGeneral=function(n){var t=getDate(new Date(n.createdDate));$("#date").html(t);n.transactionId!==""?$("#transactionId").html(n.transactionId).parent("#transactionIdHolder").show():$("#transactionIdHolder").hide();n.note!==""?$("#note").html(n.note.replace(/(?:\r\n|\r|\n)/g,"<br />")).parent("#noteHolder").show():$("#noteHolder").hide();n.invoiceNumber!==""&&n.invoiceNumber!==null?$("#invoiceNumber").html(n.invoiceNumber).parent("#invoiceNumberHolder").show():$("#invoiceNumberHolder").hide();n.refInvoiceNumber!==""&&n.refInvoiceNumber!==null?$("#refInvoiceNumber").html(n.refInvoiceNumber).parent("#refInvoiceNumberHolder").show():$("#refInvoiceNumberHolder").hide();switch(n.status){case"concept":$("#status").html("Concept");$("#downloadInvoice").hide();break;case"pending":$("#status").html("Pending payment");$("#downloadInvoice").hide();break;case"processing":$("#status").html("Processing");$("#downloadInvoice").hide();break;case"hold":$("#status").html("On hold");$("#downloadInvoice").hide();break;case"completed":$("#status").html("Completed");$("#downloadInvoice").show();break;case"cancelled":$("#status").html("Cancelled");$("#downloadInvoice").hide();break;case"credit":$("#status").html("Credit");$("#downloadInvoice").show();break;case"failed":$("#status").html("Failed");$("#downloadInvoice").hide()}};fillBilling=function(n){var t=n.billingCompany!==""?n.billingCompany+"<br />":"",r=[],i;n.billingFirstName!==""&&r.push(n.billingFirstName);n.billingLastName!==""&&r.push(n.billingLastName);t+=r.length!==0?r.join(" ")+"<br />":"";t+=n.billingAddressLine1!==""?n.billingAddressLine1+"<br />":"";t+=n.billingAddressLine2!==""?n.billingAddressLine2+"<br />":"";i=[];n.billingZipCode!==""&&i.push(n.billingZipCode);n.billingCity!==""&&i.push(n.billingCity);n.billingCountry!==""&&"<br />"+i.push("Nederland");n.billingState!==""&&"<br />"+i.push(n.billingState);t+=i.length!==0?i.join(" ")+"<br />":"";t!==""&&$("p#billing").html(t);t===""&&n.billingEmail===""&&n.billingPhoneNumber===""&&n.billingVatNumber===""?$("#noBillingInfo").show():$("#noBillingInfo").hide();n.billingEmail!==""?$("#email").html(n.billingEmail).parent("#emailHolder").show():$("#emailHolder").hide();n.billingPhoneNumber!==""?$("#phoneNumber").html(n.billingPhoneNumber).parent("#phoneNumberHolder").show():$("#phoneNumberHolder").hide();n.billingVatNumber!==""?$("#vat").html(n.billingVatNumber).parent("#vatHolder").show():$("#vatHolder").hide()};fillShipping=function(n){var i=n.shippingCompany!==""?n.shippingCompany+"<br />":"",r=[],t;n.shippingFirstName!==""&&r.push(n.shippingFirstName);n.shippingLastName!==""&&r.push(n.shippingLastName);i+=r.length!==0?r.join(" ")+"<br />":"";i+=n.shippingAddressLine1!==""?n.shippingAddressLine1+"<br />":"";i+=n.shippingAddressLine2!==""?n.shippingAddressLine2+"<br />":"";t=[];n.shippingZipCode!==""&&t.push(n.shippingZipCode);n.shippingCity!==""&&t.push(n.shippingCity);n.shippingCountry!==""&&"<br />"+t.push("Nederland");n.shippingState!==""&&"<br />"+t.push(n.shippingState);i+=t.length!==0?t.join(" ")+"<br />":"";i!==""?($("p#shipping").html(i),$("#noShippingInfo").hide()):$("#noShippingInfo").show()};createList=function(n){n.lines.length>0&&$("#list #noData").hide();var t="#list";$.each(n.lines,function(i,r){var u="#list #item"+r.id;$("#cloneRowObject").clone().appendTo(t);$(t).find("#cloneRowObject").attr("data-id",r.id).attr("id","item"+r.id);$(u).find("#item").append(r.product!==""?'<a href="'+r.product+'" target="_blank">'+r.name+"<\/a>":r.name);$(u).find("#price").append(r.discount>0?'<span style="text-decoration: line-through;">'+n.priceFormat.replace("price",roundNumber(parseFloat(r.price)+parseFloat(r.discount),n.digitsAfterDecimal))+"<\/span ><br />"+n.priceFormat.replace("price",roundNumber(r.price,n.digitsAfterDecimal)):n.priceFormat.replace("price",roundNumber(r.price,n.digitsAfterDecimal)));$(u).find("#quantity").append(r.quantity);$(u).find("#tax").append(roundNumber(r.tax,n.digitsAfterDecimal)+"%");$(u).find("#total").append(roundNumber(r.total,n.digitsAfterDecimal));$(u).find(".checkbox input").uniform().on("change",function(){var n=!1;$("#list .checkbox input, #shippings .checkbox input, #fees .checkbox input").each(function(){$(this).is(":checked")&&(n=!0)});n?$("#deleteLines").fadeIn("500"):$("#deleteLines").fadeOut("500")})});$(t).find("#edit").off().on("click",function(){lineId=$(this).parents("tr").attr("data-id");fillProductModal(lineId);$("#modalProduct").modal("show")});return!0};createFeeList=function(n){n.fees.length>0&&$("#fees #noData").hide();var t="#fees";$.each(n.fees,function(i,r){var u="#fees #item"+r.id;$("#cloneObject").clone().appendTo(t);$(t).find("#cloneObject").removeClass("hidden").attr("data-id",r.id).attr("id","item"+r.id);$(u).find("#item").append(r.name);$(u).find("#price").append(n.priceFormat.replace("price",roundNumber(r.price,n.digitsAfterDecimal)));$(u).find("#tax").append(roundNumber(r.taxRate,n.digitsAfterDecimal)+"%");$(u).find(".checkbox input").uniform().on("change",function(){var n=!1;$("#list .checkbox input, #shippings .checkbox input, #fees .checkbox input").each(function(){$(this).is(":checked")&&(n=!0)});n?$("#deleteLines").fadeIn("500"):$("#deleteLines").fadeOut("500")})});$(t).find("#edit").off().on("click",function(){feeId=$(this).parents("tr").attr("data-id");fillFeeModal(feeId);$("#modalFee").modal("show")});return!0};createShippingList=function(n){n.shippings.length>0&&$("#shippings #noData").hide();var t="#shippings";$.each(n.shippings,function(i,r){var u="#shippings #item"+r.id;$("#cloneObject").clone().appendTo(t);$(t).find("#cloneObject").removeClass("hidden").attr("data-id",r.id).attr("id","item"+r.id);$(u).find("#item").append(r.name);$(u).find("#price").append(n.priceFormat.replace("price",roundNumber(r.price,n.digitsAfterDecimal)));$(u).find("#tax").append(r.taxable?"Yes":"No");$(u).find(".checkbox input").uniform().on("change",function(){var n=!1;$("#list .checkbox input, #shippings .checkbox input, #fees .checkbox input").each(function(){$(this).is(":checked")&&(n=!0)});n?$("#deleteLines").fadeIn("500"):$("#deleteLines").fadeOut("500")})});$(t).find("#edit").off().on("click",function(){shippingMethodId=$(this).parents("tr").attr("data-id");fillShippingMethodModal(shippingMethodId);$("#modalShippingMethod").modal("show")});return!0};getDate=function(n){var t=new Date(n),i=t.getMonth()+1,r=t.getDate();return currentDate=i+"/"+r+"/"+t.getFullYear()};roundNumber=function(n,t){var i=+(Math.round(n+"e+"+t).toFixed(t)+"e-"+t);return i.toFixed(t)};getTotalFeePrice=function(n,t){var i=0;return $.each(n,function(n,r){var u=parseFloat(roundNumber(r.price,t))/(100+r.taxRate)*r.taxRate;tax=parseFloat(tax)+parseFloat(u);i=parseFloat(roundNumber(i,t))+parseFloat(roundNumber(r.price,t))}),roundNumber(i,t)};getTotalLinePrice=function(n,t){var i=0;return $.each(n,function(n,r){var f=parseFloat(roundNumber(r.price,t))/(100+parseFloat(r.tax))*parseFloat(r.tax),e=parseFloat(f*r.quantity),u;tax=parseFloat(tax)+parseFloat(e);u=parseFloat(roundNumber(r.price,t))*r.quantity;i=parseFloat(roundNumber(i,t))+parseFloat(roundNumber(u,t))}),roundNumber(i,t)};getTotalShippingPrice=function(n,t,i,r){var f=0,u={},o,s,h,e,c;$.each(t,function(n,t){var i=parseFloat(roundNumber(t.price,r))*t.quantity;f=parseFloat(f)+parseFloat(roundNumber(i,r));u[t.tax]=t.tax in u?u[t.tax]+parseFloat(roundNumber(i,r)):roundNumber(i,r)});$.each(i,function(n,t){f=parseFloat(f)+parseFloat(roundNumber(t.price,r));u[t.taxRate]=t.taxRate in u?u[t.taxRate]+roundNumber(t.price,r):roundNumber(t.price,r)});o={};for(e in u)o[e]=100/f*parseFloat(u[e]);f=0;s=0;$.each(n,function(n,t){t.taxable?f=parseFloat(roundNumber(f,r))+parseFloat(roundNumber(t.price,r)):s=parseFloat(roundNumber(s,r))+parseFloat(roundNumber(t.price,r))});h=0;for(e in o)c=f/100*o[e],tax=parseFloat(tax)+parseFloat(parseFloat(c)/(100+parseFloat(e))*parseFloat(e)),h=h+c;return roundNumber(h+s,r)};getTotalPrice=function(n,t,i){return roundNumber(parseFloat(i)+parseFloat(n)+parseFloat(t),backUp.digitsAfterDecimal)};