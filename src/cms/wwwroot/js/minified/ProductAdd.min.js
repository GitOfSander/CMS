function getItem(){data={id:id};$.ajax({url:"/api/product",dataType:"json",type:"get",data:data,success:function(n){var t=n.value;return backUp=t,fillItem(t),id!==0?($("#addTitle").addClass("hidden"),$("#editTitle").removeClass("hidden"),$("#editTitle").find("span").html(t.item.name)):$("#editTitle").addClass("hidden"),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})}function getTaxClasses(){$.ajax({url:"/spine-api/tax-classes",dataType:"json",type:"get",success:function(n){var t=n.value;return $.each(t,function(n,t){$("#taxClass").append(new Option(t.name,t.id,t.default,t.default))}),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})}function getShippingClasses(){$.ajax({url:"/spine-api/shipping-classes",dataType:"json",type:"get",success:function(n){var t=n.value;return $.each(t,function(n,t){$("#shippingClass").append(new Option(t.name,t.id))}),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})}function afterCreate(n){$("#saveProduct").html("Save");id=n.item!==null?n.item.id:0;fillFieldLanguages(n.resources);fillCategorieLanguages(n.categories);$(".tab-item input, .tab-item textarea").on("change paste keyup",function(){fieldChanged=!0});$("#tab4 #active").prop("checked",n.item!==null?n.item.active:!1);$("#tab4 #active").uniform();$("#tab4 #active").off().on("click",function(){$(this).prop("checked",!$(this).prop("checked"));$("#modalItemStatusAlert").modal("show");activateCheckbox=$("#tab4 #active").prop("checked")===!0?!1:!0})}function fillFields(n,t){fillPageDetails(n.page,t);var i=!1;n.fields.length>0&&$(t+" #fieldsHolder").removeClass("hidden");$.each(n.fields,function(n,r){if($("#cloneObject").clone(!0).appendTo(t+" #fields"),$(t+" #fields").find("#cloneObject").removeClass("hidden").data("id",r.fieldId).data("type",r.type.toLowerCase()).attr("id","f"+r.fieldId),r.type.toLowerCase()==="html5editor"){var u=$(t+" #f"+r.fieldId).find("#html5Editor").removeClass("hidden").summernote({height:200,toolbar:[["cleaner",["cleaner"]],["style",["style"]],["font",["bold","italic","underline","strikethrough","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["picture","link","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],cleaner:{notTime:2400,action:"both",newline:"<br>",notStyle:"position:absolute;top:0;left:0;right:0",icon:'<i class="note-icon">Verwijder opmaak<\/i>',keepHtml:!1,keepOnlyTags:["<p>","<br>","<ul>","<li>","<b>","<strong>","<i>","<a>"],keepClasses:!1,badTags:["style","script","applet","embed","noframes","noscript","html","div"],badAttributes:["style","start"]},popover:{image:[["custom",["imageAttributes"]],["imagesize",["imageSize100","imageSize50","imageSize25"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]],link:[["link",["linkDialogShow","unlink"]]]},lang:"nl-NL",imageAttributes:{imageDialogLayout:"default",icon:'<i class="note-icon-pencil"/>',removeEmpty:!1},displayFields:{imageBasic:!0,imageExtra:!1,linkBasic:!0,linkExtra:!1},callbacks:{onBlur:function(){fieldChanged=!0},onChange:function(){fieldChanged=!0},onImageUpload:function(n){var t=new FormData;$.each(n,function(n,i){t.append(i.name,i)});$.ajax({url:"/api/image",type:"post",contentType:!1,processData:!1,data:t,success:function(n){return $.each(n,function(n,t){u.summernote("insertImage",t,function(){})}),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})}}});u.summernote("code",r.text);$(t+" #f"+r.fieldId+" #html5Editor").data("changed",!1);fieldChanged=!1;$(t+" #f"+r.fieldId).find("label#heading").html(r.heading)}else if(r.type.toLowerCase()==="text"||r.type==="number"||r.type==="email"||r.type==="tel")$(t+" #f"+r.fieldId).find("input#input").removeClass("hidden").attr("type",r.Type).val(r.text),$(t+" #f"+r.fieldId).find("label#heading").html(r.heading);else if(r.type.toLowerCase()==="textarea")$(t+" #f"+r.fieldId).find("textarea#textarea").removeClass("hidden").val(r.text),$(t+" #f"+r.fieldId).find("label#heading").html(r.heading);else if(r.type.toLowerCase()==="textarea")$(t+" #f"+r.fieldId).find("input#rgba").removeClass("hidden").val(r.text),$(t+" #f"+r.fieldId).find("label#heading").html(r.heading);else if(r.type.toLowerCase()==="checkbox")$(t+" #f"+r.fieldId).find("#checkbox").removeClass("hidden").find("input").prop("checked",r.text.toString().toLowerCase()==="true"?!0:!1).uniform(),$(t+" #f"+r.fieldId).find("label#heading").html(r.heading);else if(r.type.toLowerCase()==="rgba")i=!0,$(t+" #f"+r.fieldId).find("input#rgba").removeClass("hidden").val(r.text),$(t+" #f"+r.fieldId).find("label#heading").html(r.heading);else if(r.type.toLowerCase()==="selectlinkedto"){$(t+" #f"+r.fieldId).find("select#select").removeClass("hidden").select2({multiple:!0,placeholder:"Select "+r.heading.toLowerCase()+"...",data:r.data}).val(r.text).trigger("change").on("change",function(){fieldChanged=!0});$(t+" #f"+r.fieldId).find("label#heading").html(r.heading)}$(t+" #f"+r.fieldId).find(".hidden").remove()});$(t+" #fields input, "+t+" #fields textarea").off().on("change paste keyup",function(){fieldChanged=!0});if(i)$(t+" #fields .rgba").off().colorpicker().on("changeColor",function(){fieldChanged=!0});$(t+" #fields #checkbox input").off().change(function(){var n=$(this).prop("checked",$(this).is(":checked"));$.uniform.update(n);fieldChanged=!0});$("#main-wrapper").fadeIn(500)}function fillUploads(n){$("#uploads").empty();var t=n.length;$.each(n,function(n,i){$("#cloneUploadObject").clone().appendTo("#uploads");$("#uploads").find("#cloneUploadObject").removeClass("hidden").attr("id","u"+i.id).attr("data-id",i.id);$("#u"+i.id).find("h3").html(i.heading);$("#u"+i.id).find("#uploader").attr("id","uploader"+i.id);$(".saveFileOrder").off().on("click",function(){var n=$(this).parents(".uploadHolder").data("id");saveFileOrder(n)});n===t-1&&$("#u"+i.id).find("#divider").remove();var r=$("#uploader"+i.id).off().pluploadQueue({runtimes:"html5,flash,silverlight,html4",url:"/api/product-file",chunk_size:i.maxSize+"mb",rename:!0,dragdrop:!0,multiple_queues:!0,filters:{max_file_size:i.maxSize,mime_types:[{title:"Files",extensions:i.fileExtensions}]},multipart:!0,multipart_params:{width:i.width,height:i.height,autoCrop:!1,uploadId:i.id,id:id},flash_swf_url:"~/plugins/plupload/js/Moxie.swf",silverlight_xap_url:"~/plugins/plupload/js/Moxie.xap",init:{BeforeUpload:function(n,t){n.settings.multipart_params.filename=t.name},UploadComplete:function(){fillFiles(id,i)},FileUploaded:function(n,t,i){var r=$.parseJSON(i.response);toastr[r.value.messageType](r.value.message)},Error:function(n,t){(t.status===401||t.status===403)&&(toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500))}}});$("#uploader"+i.id+" .plupload_add").on("click",function(n){n.preventDefault();var t=document.getElementById(r[0].id+"_html5");t&&!t.disabled&&t.click()});fillFiles(id,i)});$(".plupload_start").each(function(){$(this).html("Upload")})}function fillFiles(n,t){var i={id:n,uploadId:t.id};$.ajax({url:"/api/product-files",dataType:"json",type:"get",data:i,success:function(i){$("#u"+t.id+" .nestable ol").html("");$.each(i.value,function(i,r){var u;$("#cloneListObject").clone().appendTo("#u"+t.id+" .nestable ol");$("#u"+t.id+" .nestable").find("#cloneListObject").removeClass("hidden").attr("id","file"+r.id).attr("data-id",r.id);u=r.originalPath.substr(r.originalPath.lastIndexOf(".")+1).toLowerCase();switch(u){case"jpg":case"jpeg":case"png":case"gif":$("#file"+r.id).find(".dd3-content img").removeClass("hidden").attr("src",r.compressedPath+"?lastmod="+new Date);$("#file"+r.id+" .image-crop img").attr("src",r.originalPath);$("#file"+r.id).find("#video").remove();$("#file"+r.id).find("#pdf").remove();u!=="png"&&($("#file"+r.id).find(".image-crop").addClass("image-crop-bg-black"),$("#file"+r.id).find(".img-preview").css("background-color","#000000"));u!=="jpg"&&$("#file"+r.id).find(".image-quality").addClass("hidden");$("#file"+r.id).find("#qualitySlider").change(function(){$("#file"+r.id).find("#quality").html("("+$(this).val()+")")});var f=$("#file"+r.id+" .image-crop > img"),e=t.width,o=t.height;$("#file"+r.id+" #openCropMdl").on("click",function(){$("#file"+r.id+" #imageCropMdl").modal("show");setTimeout(function(){f.cropper({aspectRatio:e/o,preview:"#file"+r.id+" .img-preview"})},400)});$("#file"+r.id+" #openCropMdl").on("hidden.bs.modal",function(){f.cropper("destroy")});$("#file"+r.id+" #crop").on("click",function(){$(".modal").modal("hide")&&f.cropper("getCroppedCanvas").toBlob(function(i){var u=new FormData;u.append("id",r.id);u.append("type","product");u.append("croppedImage",i);u.append("quality",$("#file"+r.id).find("#qualitySlider").val());$.ajax("/spine-api/image/crop",{method:"POST",data:u,processData:!1,contentType:!1,success:function(i){var r=i.value;toastr[r.messageType](r.message);fillFiles(n,t)},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}}})})});break;case"mp4":case"ogv":case"webm":u==="ogv"&&(u="ogg");$("#file"+r.id).find("#video").removeClass("hidden").find("source").attr("src",r.originalPath+"?lastmod="+new Date).attr("type","video/"+u);$("#file"+r.id).find("img").remove();$("#file"+r.id).find("#cropHolder").remove();$("#file"+r.id).find("#imageCropMdl").remove();$("#file"+r.id).find("#pdf").remove();break;case"pdf":$("#file"+r.id).find("#pdf").removeClass("hidden").find("a").attr("href",r.originalPath);$("#file"+r.id).find("img").remove();$("#file"+r.id).find("#cropHolder").remove();$("#file"+r.id).find("#imageCropMdl").remove();$("#file"+r.id).find("#video").remove()}$("#file"+r.id).find("#checkbox").find("input").prop("checked",r.active).uniform();$("#file"+r.id).find("#alt").val(r.Alt)});$("#u"+t.id+" .nestable").nestable({dragClass:"dd-dragel page-file-dd-item",maxDepth:1});$(".dd-item .active").off().on("click",function(){$(this).prop("checked",!$(this).prop("checked"));$("#modalStatusAlert").modal("show");fileId=$(this).parents(".dd-item").attr("data-id");activateCheckbox=$(this).prop("checked")===!0?!1:!0});$(".saveAlt").off().on("click",function(){fileId=$(this).parents("li").data("id");var n=$(this).parents("li").find("input#alt").val();saveFileAlt(fileId,n)});$(".openDeleteFileModal").off().on("click",function(){fileId=$(this).parents("li").data("id");$("#modalDeleteFileAlert").modal("show")});return(typeof i.value!="undefined"?i.value.length>1:!1)&&$("#u"+t.id+" .saveFileOrder").removeClass("hidden"),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})}function deleteItem(){data={Id:id};$.ajax({url:"/api/delete-product",dataType:"json",type:"post",data:data,success:function(n){var t=n.value;return toastr[t.messageType](t.message),location.href="/products",!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})}function deleteFile(n){data={Id:n};$.ajax({url:"/api/delete-product-file",dataType:"json",type:"post",data:data,success:function(t){var r=t.value,i;return toastr[r.messageType](r.message),$("#modalDeleteFileAlert").modal("hide"),i=$('.nestable li[data-id="'+n+'"]').parents(".uploadHolder").data("id"),$('.nestable li[data-id="'+n+'"]').remove(),$("#u"+i+" ol > li").length<2&&$("#u"+i).find(".saveFileOrder").addClass("hidden"),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})}function saveFileStatus(n){var t={id:n,active:activateCheckbox};$.ajax({url:"/api/product-file-active",dataType:"json",type:"post",contentType:"application/json;",data:JSON.stringify(t),success:function(t){var i=t.value,r;return toastr[i.messageType](i.message),r=$("#file"+n).find("#active").prop("checked",activateCheckbox),$.uniform.update(r),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}});$("#modalStatusAlert").modal("hide")}function saveFileAlt(n,t){var i={id:n,alt:t};$.ajax({url:"/api/product-file-alt",dataType:"json",type:"post",contentType:"application/json;",data:JSON.stringify(i),success:function(n){var t=n.value;return toastr[t.messageType](t.message),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})}function saveFileOrder(n){var t=$(".uploadHolder[data-id='"+n+"'] .nestable").nestable("serialize");$.ajax({url:"/api/product-files-custom-order",dataType:"json",type:"post",contentType:"application/json;",data:JSON.stringify(t),success:function(n){var t=n.value;return toastr[t.messageType](t.message),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})}function updateItem(n){updateItemBackup();var t={item:backUp.item,categories:backUp.categories};$.ajax({url:"/api/product",dataType:"json",type:"post",contentType:"application/json;",data:JSON.stringify(t),success:function(t){var i=t.value;return toastr[i.messageType](i.message),id===0&&(id=i.item.id,backUp.item.id=i.item.id,$("#addTitle").addClass("hidden"),$("#editTitle").removeClass("hidden"),$("#editTitle").find("span").html(i.item.name)),$("#rootwizard").bootstrapWizard("show",n),fieldChanged=!1,!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message);fieldChanged=!1}return!0}})}function updateResources(n){updateResourcesBackup();var t={id:id,resources:backUp.resources};$.ajax({url:"/api/product-resources",dataType:"json",type:"post",contentType:"application/json;",data:JSON.stringify(t),success:function(t){var i=t.value;return toastr[i.messageType](i.message),$("#tab2 #tabs").empty(),fillFieldLanguages(i.resources),$("#rootwizard").bootstrapWizard("show",n),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return $("#tab2 #tabs").empty(),fillFieldLanguages(backUp.resources),!0}})}function updateActive(){var n={id:id,active:activateCheckbox};$.ajax({url:"/api/product-active",dataType:"json",type:"post",contentType:"application/json;",data:JSON.stringify(n),success:function(n){var t=n.value,i;return toastr[t.messageType](t.message),i=$("#tab4 #active").prop("checked",activateCheckbox),$.uniform.update(i),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})}function fillPageDetails(n,t){if(n!==null){$(t+" #pageTitle").val(n.title);$(t+" #pageUrl").val(n.url);$(t).find("#url").html(backUp.url);$(t).find("#pageUrl").on("keyup input propertychange",function(n){n.keyCode!==37&&n.keyCode!==39&&n.keyCode!==0&&createFriendlyUrl(this,t+" #pageUrl",".form-group")});console.log(n.keywords);$(t).find("#pageKeywords").tagsinput("add",n.keywords);$(t+" #pageDescription").val(n.description)}else $(t+" #pageKeywords").tagsinput("add","");validateDataInformation=$("#wizardForm").validate({ignore:[],errorPlacement:function(n,t){t.parent(".tags-input").length?n.appendTo(t.parent()):t.parent(".input-group").length?n.insertAfter(t.parent()):n.insertAfter(t)},rules:{pageTitle:{required:!0,maxlength:200},pageUrl:{required:!0,maxlength:200},pageKeywords:{maxlength:400},pageDescription:{maxlength:400}},messages:{pageTitle:{required:"Enter a title."},pageUrl:{required:"Enter an url."}},onkeyup:function(n){$(n).valid()}})}function fillItem(n){var t=n.item,i=!1,r;t!=null?($("#name").val(t.name),$("#price").val(parseFloat(t.price).toFixed(n.settings.digitsAfterDecimal)),$("#promoPrice").val(t.price!==t.promoPrice?parseFloat(t.promoPrice).toFixed(n.settings.digitsAfterDecimal):""),$("#taxClass").find('option[value="'+t.taxClassId+'"]').attr("selected",!0),t.promoSchedule===!0&&($("#promoScheduleInputs").removeClass("hidden"),i=$("#promoSchedule").prop("checked",t.promoSchedule),$.uniform.update(i)),$("#sku").val(t.sku),$("#maxOrderProduct").val(t.maxPerOrder!==0?t.maxPerOrder:""),t.manageStock===!0?($("#manageStockInputs").removeClass("hidden"),$("#stockQuantity").val(t.stockQuantity),$("#backorders").find('option[value="'+t.backorders+'"]').attr("selected","selected"),i=$("#manageStock").prop("checked",t.manageStock),$.uniform.update(i)):($("#stockStatusHolder").removeClass("hidden"),$("#stockStatus").find('option[value="'+t.stockStatus+'"]').attr("selected","selected")),$("#shippingClass").find('option[value="'+t.shippingClassId+'"]').attr("selected","selected"),$("#weight").val(t.weight!==0?t.weight:""),$("#length").val(t.length!==0?t.length:""),$("#width").val(t.width!==0?t.width:""),$("#height").val(t.height!==0?t.height:"")):$("#stockStatusHolder").removeClass("hidden");r=getDate(t!==null?new Date(t.promoFromDate):new Date);$("input#promoFromDate").datepicker({orientation:"top auto",autoclose:!0}).datepicker("update",r).on("input change",function(){$("#save").attr("disabled",!1);fieldChanged=!0});$("input#promoFromTime").timepicker({defaultTime:t!==null?new Date(t.promoFromDate):new Date});r=getDate(t!==null?new Date(t.promoToDate):new Date);$("input#promoToDate").datepicker({orientation:"top auto",autoclose:!0}).datepicker("update",r).on("input change",function(){$("#save").attr("disabled",!1);fieldChanged=!0});$("input#promoToTime").timepicker({defaultTime:t!==null?new Date(t.promoToDate):new Date});n.settings.reviews?(i=$("#reviews").prop("checked",t.reviews),$.uniform.update(i)):$("#reviewsHolder").remove();(n.settings.upsells||n.settings.crossSells)&&($("#linkedProducts").removeClass("hidden"),$("#tabLinkedProducts").removeClass("hidden"));afterCreate(backUp)}function fillCategorieLanguages(n){$.each(n,function(n,t){$("#tab1 #cloneTab").clone(!0).appendTo("#tab1 #tabs");$("#tab1 #tabs").find("#cloneTab").removeClass("hidden").data("id",t.id).data("language",t.code.toLowerCase()).attr("id","c"+t.id).addClass("tab-categories");t.current?($("#tab1 .languageSwitch").append('<a href="#c'+t.id+'" role="tab" data-toggle="tab" aria-expanded="false" class="btn btn-default active">'+t.code+"<\/a>"),$("#tab1 .languageSwitch").addClass("active").addClass("in"),$("#c"+t.id).addClass("active").addClass("in")):$("#tab1 .languageSwitch").append('<a href="#c'+t.id+'" role="tab" data-toggle="tab" aria-expanded="false" class="btn btn-default">'+t.code+"<\/a>");var i=[];$.each(t.categories,function(n,t){i.push(t.id)});$("#c"+t.id+" #selectCategories").select2({multiple:!0,placeholder:"Select a category",allowClear:!0,data:t.categories,ajax:{delay:250,url:"/spine-api/categories-by-name",dataType:"json",data:function(n){return{term:n.term}},processResults:function(n){return n.value.data}}}).val(i).trigger("change").on("change",function(){fieldChanged=!0});fieldChanged=!1});$("#tab1 .languageSwitch a").off().on("click",function(){$("#tab1 .languageSwitch a").removeClass("active");$(this).addClass("active")});n.length==1&&$("#tab1 .languageSwitch").remove()}function fillFieldLanguages(n){$.each(n,function(n,t){$("#tab2 #cloneTab").clone(!0).appendTo("#tab2 #tabs");$("#tab2 #tabs").find("#cloneTab").removeClass("hidden").data("id",t.id).data("language",t.code.toLowerCase()).attr("id","t"+t.id).addClass("tab-resources");t.current?($("#tab2 .languageSwitch").append('<a href="#t'+t.id+'" role="tab" data-toggle="tab" aria-expanded="false" class="btn btn-default active">'+t.code+"<\/a>"),$("#t"+t.id).addClass("active").addClass("in")):$("#tab2 .languageSwitch").append('<a href="#t'+t.id+'" role="tab" data-toggle="tab" aria-expanded="false" class="btn btn-default">'+t.code+"<\/a>");fillFields(t,"#t"+t.id)});$("#tab2 .languageSwitch a").off().on("click",function(){$("#tab2 .languageSwitch a").removeClass("active");$(this).addClass("active")});n.length==1&&$("#tab2 .languageSwitch").remove()}function updateItemBackup(){backUp.item===null&&(backUp.item={});backUp.item.name=$("#name").length===1?$("#name").val():backUp.item.name===undefined?"":backUp.item.name;backUp.item.price=parseFloat($("#price").length===1?$("#price").val()===""?0:$("#price").val():backUp.item.price===undefined?0:backUp.item.price).toFixed(2);backUp.item.promoPrice=parseFloat($("#promoPrice").length===1?$("#promoPrice").val()===""?backUp.item.price:$("#promoPrice").val():backUp.item.promoPrice===undefined?0:backUp.item.promoPrice).toFixed(2);backUp.item.taxStatus="taxable";backUp.item.taxClassId=parseInt($("#taxClass").length===1?$("#taxClass option:selected").val():backUp.item.taxClass===undefined?"":backUp.item.taxClass);backUp.item.reviews=$("#reviews").length===1?$("#reviews").is(":checked"):backUp.item.reviews===undefined?!1:backUp.item.reviews;backUp.item.sku=$("#sku").length===1?$("#sku").val():backUp.item.sku===undefined?"":backUp.item.sku;backUp.item.manageStock=$("#manageStock").length===1?$("#manageStock").is(":checked"):backUp.item.manageStock===undefined?!1:backUp.item.manageStock;backUp.item.stockQuantity=parseInt($("#stockQuantity").length===1?$("#stockQuantity").val()===""?0:$("#stockQuantity").val():backUp.item.stockQuantity===undefined?0:backUp.item.stockQuantity);backUp.item.backorders=$("#backorders").length===1?$("#backorders option:selected").val():backUp.item.backorders===undefined?"no":backUp.item.backorders;backUp.item.stockStatus=$("#stockStatus").length===1?$("#stockStatus option:selected").val():backUp.item.stockStatus===undefined?"stock":backUp.item.stockStatus;backUp.item.maxPerOrder=parseInt($("#maxOrderProduct").length===1?$("#maxOrderProduct").val()===""?0:$("#maxOrderProduct").val():backUp.item.maxPerOrder===undefined?0:backUp.item.maxPerOrder);backUp.item.shippingClassId=parseInt($("#shippingClass").length===1?$("#shippingClass").val():backUp.item.shippingClass===undefined?"":backUp.item.shippingClass);backUp.item.weight=parseFloat($("#weight").length===1?$("#weight").val()===""?0:$("#weight").val():backUp.item.weight===undefined?0:backUp.item.weight).toFixed(2);backUp.item.width=parseFloat($("#width").length===1?$("#width").val()===""?0:$("#width").val():backUp.item.width===undefined?0:backUp.item.width).toFixed(2);backUp.item.height=parseFloat($("#height").length===1?$("#height").val()===""?0:$("#height").val():backUp.item.height===undefined?0:backUp.item.height).toFixed(2);backUp.item.length=parseFloat($("#length").length===1?$("#length").val()===""?0:$("#length").val():backUp.item.length===undefined?0:backUp.item.length).toFixed(2);backUp.item.promoSchedule=$("#promoSchedule").length===1?$("#promoSchedule").is(":checked"):backUp.item.promoSchedule===undefined?!1:backUp.item.promoSchedule;backUp.item.promoFromDate=$("#promoFromDate").length===1&&$("#promoFromTime").length===1?$("#promoFromDate").val()+" "+$("#promoFromTime").val():backUp.item.promoFromDate===undefined?new Date:backUp.item.promoFromDate;backUp.item.promoToDate=$("#promoToDate").length===1&&$("#promoToTime").length===1?$("#promoToDate").val()+" "+$("#promoToTime").val():backUp.item.promoToDate===undefined?new Date:backUp.item.promoToDate;$(".tab-categories").each(function(){for(var t=$(this).data("language"),n=0;n<backUp.categories.length;n++)if(backUp.categories[n].code===t){backUp.categories[n].categories=$(this).find("select").val();break}})}function updateResourcesBackup(){$(".tab-resources").each(function(){for(var t=$(this).data("language"),n=0;n<backUp.resources.length;n++)if(backUp.resources[n].code===t){resources=backUp.resources[n];backUp.resources[n].page===null&&(backUp.resources[n].page={});backUp.resources[n].page.title=$(this).find("#pageTitle").val();backUp.resources[n].page.url=$(this).find("#pageUrl").val();backUp.resources[n].page.keywords=$(this).find("#pageKeywords").val();backUp.resources[n].page.description=$(this).find("#pageDescription").val();backUp.resources[n].page.active=!0;$(this).find("#fields input#input, #fields input#cb, #fields input#rgba, #fields textarea#textarea, #fields #html5Editor, #fields select#select").each(function(){for(var i=$(this).parents(".form-group").data("id"),t="",t=$(this).is("input[type='checkbox']")?$(this).is(":checked").toString().toLowerCase():$(this).parents(".form-group").data("type")==="html5editor"?$(this).summernote("code"):$(this).val(),n=0;n<resources.fields.length;n++)if(resources.fields[n].fieldId===i){resources.fields[n].text=t;break}});break}})}function getDate(n){var t=new Date(n),i=t.getMonth()+1,r=t.getDate();return currentDate=i+"/"+r+"/"+t.getFullYear()}var fieldChanged=!1,id=0,wizardGoTo=0,backUp,fileId,activateCheckbox,validateDataInformation,validateProduct;$(document).ready(function(){document.execCommand("defaultParagraphSeparator",!1,"p");$("#manageStock").uniform();$("#promoSchedule").uniform();$("#reviews").uniform();$("#manageStock").on("click",function(){$(this).prop("checked")===!0?($("#manageStockInputs").removeClass("hidden"),$("#stockStatusHolder").addClass("hidden")):($("#manageStockInputs").addClass("hidden"),$("#stockStatusHolder").removeClass("hidden"))});$("#promoSchedule").on("click",function(){$(this).prop("checked")===!0?$("#promoScheduleInputs").removeClass("hidden"):$("#promoScheduleInputs").addClass("hidden")});getTaxClasses();getShippingClasses();id=$("#productId").val()!==""?$("#productId").val():0;$("#navigation #navProducts").addClass("active").parents("li").addClass("active").addClass("open").find(".sub-menu").slideDown();getItem();$("#create").click(function(){updateItem(wizardGoTo);$("#modalCreateAlert").modal("hide")});$("#updateResources").click(function(){updateResources(wizardGoTo);$("#modalUpdateAlert").modal("hide")});$("#close").click(function(){fieldChanged=!1;$("#fields").empty();fillFieldLanguages(backUp.resources);$("#modelAlert").modal("hide");$("#rootwizard").bootstrapWizard("show",wizardGoTo)});$("#saveProduct").on("click",function(){wizardGoTo=0;var n=$("form#wizardForm").valid();return n?id===0?($("#modalCreateAlert").find("#createText").removeClass("hidden"),$("#modalCreateAlert").find("#updateText").addClass("hidden"),$("#modalCreateAlert").find("#createBtn").removeClass("hidden"),$("#modalCreateAlert").find("#updateBtn").addClass("hidden"),$("#modalCreateAlert").modal("show"),!1):id!==0?($("#modalCreateAlert").find("#updateText").removeClass("hidden"),$("#modalCreateAlert").find("#createText").addClass("hidden"),$("#modalCreateAlert").find("#updateBtn").removeClass("hidden"),$("#modalCreateAlert").find("#createBtn").addClass("hidden"),$("#modalCreateAlert").modal("show"),!1):void 0:(validateProduct.focusInvalid(),!1)});$("#save").on("click",function(){return wizardGoTo=1,$("#modalUpdateAlert").modal("show"),!1});$("#rootwizard").bootstrapWizard({tabClass:"nav nav-tabs",onTabShow:function(n,t,i){var r=t.find("li").length,u=i+1,f=u/r*100;$("#rootwizard").find(".progress-bar").css({width:f+"%"})},onTabClick:function(n,t,i,r){wizardGoTo=r;switch(i){case 0:var u=$("form#wizardForm").valid();return u?id===0?($("#modalCreateAlert").find("#createText").removeClass("hidden"),$("#modalCreateAlert").find("#updateText").addClass("hidden"),$("#modalCreateAlert").find("#createBtn").removeClass("hidden"),$("#modalCreateAlert").find("#updateBtn").addClass("hidden"),$("#modalCreateAlert").modal("show"),!1):fieldChanged&&id!==0?($("#modalCreateAlert").find("#updateText").removeClass("hidden"),$("#modalCreateAlert").find("#createText").addClass("hidden"),$("#modalCreateAlert").find("#updateBtn").removeClass("hidden"),$("#modalCreateAlert").find("#createBtn").addClass("hidden"),$("#modalCreateAlert").modal("show"),!1):!0:(validateProduct.focusInvalid(),!1)}}});$('a[data-toggle="tab"]').on("shown.bs.tab",function(n){var t=$(n.target).attr("href");t==="#tab3"&&fillUploads(backUp.uploads)});$("#delete").on("click",function(){deleteItem()});$("#deleteFile").on("click",function(){deleteFile(fileId)});$("#saveFileStatus").on("click",function(){saveFileStatus(fileId)});$("#saveStatus").click(function(){updateActive()});jQuery.validator.addMethod("decimal",function(n,t){return this.optional(t)||n.match(new RegExp("^\\d{0,14}(?:\\.\\d{0,2})?$"))},"Please enter only digits and max 2 digits after decimal and 14 before.");setProductValidation()});setProductValidation=function(){validateProduct=$("form#wizardForm").validate({ignore:[],ignoreTitle:!0,errorPlacement:function(n,t){n[0].outerText!==""&&(t.parent(".tags-input").length?n.appendTo(t.parent()):t.parent(".input-group").length?n.insertAfter(t.parent()):n.insertAfter(t),$('.nav-tabs li a[href="#'+t.parents(".tab-pane").attr("id")+'"]').css("color","#c84348").tooltip({placement:"bottom",title:"There are some errors in this tab on the inputs. Click to see more."}),$('.nav-tabs li a[href="#'+t.parents(".tab-pane").attr("id")+'"] span').length===0&&$('.nav-tabs li a[href="#'+t.parents(".tab-pane").attr("id")+'"]').append('<span aria-hidden="true" class="icon-info pull-right" style="margin-top: 3px;"><\/span>'))},unhighlight:function(n){if(n.id!==""){var t=$("#"+n.id).parents(".tab-pane");t.find("label.error:visible").length===0&&$('.nav-tabs li a[href="#'+t.attr("id")+'"]').removeAttr("style").tooltip("destroy").find("span").remove()}},success:function(n,t){var i=$(t.id).parents(".tab-pane");n.remove();i.find("label.error:visible").length===0&&$('.nav-tabs li a[href="#'+i.attr("id")+'"]').removeAttr("style").tooltip("destroy").find("span").remove()},rules:{name:{required:!0,maxlength:255},price:{required:!0,decimal:!0},promoPrice:{required:!1,decimal:!0},stockQuantity:{required:!1,digits:!0},maxOrderProduct:{required:!1,digits:!0},weight:{required:!1,digits:!0},length:{required:!1,digits:!0},width:{required:!1,digits:!0},height:{required:!1,digits:!0},sku:{maxlength:200}},messages:{name:{required:"Name is required."},price:{required:"Price is required."}},onkeyup:function(n){$(n).valid()}})};