function fillUser(n){$('#preamble option[value="'+n.preamble+'"]').attr("selected",!0);$("#firstName").val(n.firstName);$("#lastName").val(n.lastName);n.email!==""||$("#userId").val()===""?($("#email").val(n.email),$("#emailHolder").removeClass("hidden")):$("#emailHolder").remove();n.phoneNumber!==""||$("#userId").val()===""?($("#phoneNumber").val(n.phoneNumber),$("#phoneNumberHolder").removeClass("hidden")):$("#phoneNumberHolder").remove();n.options?$("#optionsHolder").removeClass("hidden"):$("#optionsHolder").remove();n.roles.length!==0?($.each(n.roles,function(t,i){var r=!1;i.Id===n.roleId&&(r=!0);$("#roles").append($("<option>",{value:i.Id,text:i.Name,selected:r}))}),$("#roleHolder").removeClass("hidden")):$("#roleHolder").remove();$("#userId").val()!==""&&($("#displayFirstName").val(n.firstName),$("#firstName").off().keyup(function(){$("#displayFirstName").html($(this).val())}),$("#displayLastName").val(n.lastName),$("#lastName").off().keyup(function(){$("#displayLastName").html($(this).val())}));$("#update").off().on("click",function(){UpdateUser()});$("#main-wrapper").show("fade",500,FormFadeCallback())}function UpdateUser(){var t=$("#form").valid(),n;if(!t)return validation.focusInvalid(),!1;n={Id:$("#userId").val(),Preamble:$("#preamble option:selected").val(),FirstName:$("#firstName").val(),LastName:$("#lastName").val(),Email:$("#email").val(),PhoneNumber:$("#phoneNumber").val(),ConcurrencyStamp:concurrencyStamp,Role:$("#roles option:selected").text()};$.ajax({url:"/spine-api/user",dataType:"json",type:"post",data:n,success:function(n){var t=n.value;return toastr[t.messageType](t.message),concurrencyStamp=t.concurrencyStamp,$("#preambleHolder").find(".help-block").addClass("hidden").html(""),$("#firstNameHolder").find(".help-block").addClass("hidden").html(""),$("#lastNameHolder").find(".help-block").addClass("hidden").html(""),$("#emailHolder").find(".help-block").addClass("hidden").html(""),$("#phoneNumberHolder").find(".help-block").addClass("hidden").html(""),$("#roleHolder").find(".help-block").addClass("hidden").html(""),t.redirect!==null&&t.redirect!==undefined&&setTimeout(function(){location.href=t.redirect},4500),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;t.messageType==="modelAlert"?(concurrencyStamp=t.concurrencyStamp,$("#modelAlert").modal("show"),$("#preambleHolder").find(".help-block").removeClass("hidden").html(t.preamble),$("#firstNameHolder").find(".help-block").removeClass("hidden").html(t.firstName),$("#lastNameHolder").find(".help-block").removeClass("hidden").html(t.lastName),$("#emailHolder").find(".help-block").removeClass("hidden").html(t.email),$("#phoneNumberHolder").find(".help-block").removeClass("hidden").html(t.phoneNumber),$("#roleHolder").find(".help-block").removeClass("hidden").html(t.role)):toastr[t.messageType](t.message)}return!0}})}function DeleteUser(){var n={Id:$("#userId").val()};$.ajax({url:"/spine-api/user/delete",dataType:"json",type:"post",data:n,success:function(n){var t=n.value;return toastr[t.messageType](t.message),setTimeout(function(){location.href=t.redirect},4500),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}})}function FormFadeCallback(){validation=$("#form").validate({rules:{firstName:"required",lastName:"required",email:"required"},messages:{firstName:"Enter your first name.",lastName:"Enter your last name.",email:"Enter your email address."},onkeyup:function(n){$(n).valid()}})}var concurrencyStamp,validation;$(document).ready(function(){$("#navigation #navUsers").addClass("active").parents("li").addClass("active").addClass("open").find(".sub-menu").slideDown();var n={Id:$("#userId").val()};$.ajax({url:"/spine-api/user",dataType:"json",type:"get",data:n,contentType:"application/json;",success:function(n){var t=n.value;return concurrencyStamp=t.concurrencyStamp,fillUser(t),!0},error:function(n){if(n.status===401||n.status===403)toastr.warning("You are unauthorized to do this. You will be redirected to the login screen."),setTimeout(function(){location.href="/"},4500);else{var t=n.responseJSON.value;toastr[t.messageType](t.message)}return!0}});$("#deleteUser").on("click",function(){DeleteUser()})});